const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./MyTable-D1FbPMwN.js","./index-DZEcYG8Q.js","./index-C6k8ZUm0.css","./MyApp-DRRa55Bd.js","./index-BA5m7QhG.js","./index-DOt91uSA.js","./DownOutlined-BrkIPj-I.js","./Table-DDck-vB7.js","./addEventListener-C9VBchln.js","./List-BPJoeCz4.js","./index-BRk8JeT5.js","./index-CEGXIRel.js","./index-BQAhaSn9.js","./index-KPoWFIyW.js","./dropdown-BoVCRztz.js","./Dropdown-BgvXKd3u.js","./PurePanel-Beni9Vkb.js","./move-Bzyc79vL.js","./index-D9U4WvIE.js","./index-CvALG2oX.js","./SearchOutlined-Bh66KhXc.js","./useBreakpoint-HjQEkdEA.js","./Pagination-Dv2YSLQ3.js","./Input-LTpJ6AuY.js","./row-BgRGnxnv.js","./index-B87p3I4c.js","./EyeOutlined-BBPXKIU8.js","./WordStatisticButton-BogWpezO.js","./BadgeWrapper-D8uZ2wKG.js","./index-l5dW_dFo.js","./index-iP3EwXx5.js","./index-CiDxWY8X.js","./ExportButton-CPuYvz9B.js","./useVIP-CGpIDALh.js","./sweetalert2.esm.all-BZxvatOx.js","./getIds-BE6G2xp0.js"])))=>i.map(i=>d[i]);
import{a$ as e,bc as t,r as a,b1 as i,b5 as n,b2 as r,bk as s,aY as o}from"./index-DZEcYG8Q.js";import{u as l,v as d,S as m,c,g as p,T as u,A as h,b as j,o as g,C as v}from"./MyApp-DRRa55Bd.js";import{u as x}from"./useForceStop-tD0KGOJD.js";import f,{getCacheByKey as y}from"./useCacheState-D4ghBCVU.js";import{JoinedGroupType as b,getOtherJoinedGroups as _,JoinedGroupTypeName as k}from"./groups-B049n8MW.js";import{checkVIP as w}from"./useVIP-CGpIDALh.js";import{I}from"./index-BE0FsmaM.js";import{S as C}from"./index-D9U4WvIE.js";import"./sweetalert2.esm.all-BZxvatOx.js";import"./getIds-BE6G2xp0.js";import"./index-B87p3I4c.js";import"./Input-LTpJ6AuY.js";import"./EyeOutlined-BBPXKIU8.js";import"./SearchOutlined-Bh66KhXc.js";import"./index-CiDxWY8X.js";import"./Dropdown-BgvXKd3u.js";import"./addEventListener-C9VBchln.js";import"./List-BPJoeCz4.js";import"./PurePanel-Beni9Vkb.js";import"./index-CvALG2oX.js";import"./move-Bzyc79vL.js";import"./DownOutlined-BrkIPj-I.js";const E=r((()=>o((()=>import("./MyTable-D1FbPMwN.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url)),{fallback:v}),T=r((()=>o((()=>import("./WordStatisticButton-BogWpezO.js")),__vite__mapDeps([27,1,2,3,28,29,30,16,31,15,5,6]),import.meta.url)),{fallback:v}),D=r((()=>o((()=>import("./ExportButton-CPuYvz9B.js")),__vite__mapDeps([32,1,2,3,33,34,35,25,23,26,20,31,15,13,14,16,17]),import.meta.url)),{fallback:v});function L({target:r}){const{message:o}=e.useApp(),v=t(),L=x(),{ti:N}=l(),[S,O]=a.useState(!1),[A,M]=f("JoinedGroups.type",null),P="JoinedGroups.data."+A+"."+(null==r?void 0:r.id),[V,$]=f(P,[]);a.useEffect((()=>{var e;(null==r?void 0:r.id)&&A&&P&&B(!(null==(e=y(P))?void 0:e.length))}),[null==r?void 0:r.id,A,P]);const B=async(e=!1)=>{var t;if(!(null==r?void 0:r.id)||!A)return;if(A!==b.MUTUAL&&!(await w()))return;const a=L.start();let i=[...e?[]:y(P)||[]],n=(null==(t=i[i.length-1])?void 0:t.cursor)||"";O(!0);try{for(;!a.value();){const e=await _({uid:r.id,cursor:n,type:A});if(!(null==e?void 0:e.length))break;n=e[e.length-1].cursor,i=[...i,...e].map(((e,t)=>({...e,recent:t}))),$(i),await d(500)}o.success({content:N({en:"Load groups success ",vi:"Tải nhóm xong "})+A+": "+i.length})}catch(s){o.error({content:N({en:"Error: ",vi:"Lỗi: "})+s.message})}finally{$(i),O(!1)}},J=[{title:"#",dataIndex:"recent",key:"recent",render:(e,t,a)=>(t.recent||0)+1,sorter:(e,t)=>e.recent-t.recent,width:60},{title:N({en:"Cover",vi:"Ảnh"}),key:"cover",dataIndex:"image",render:(e,t,a)=>i.jsx(I,{src:t.image,style:{width:150,height:100,objectFit:"contain"}}),width:150},{title:N({en:"Name",vi:"Tên"}),key:"name",dataIndex:"name",sorter:(e,t)=>e.name.localeCompare(t.name),render:(e,t,a)=>i.jsxs(m,{direction:"vertical",style:{maxWidth:250},children:[i.jsx(c.Link,{strong:!0,href:t.url,target:"_blank",children:t.name}),i.jsx(c.Text,{type:"secondary",children:t.id})]})},{title:N({en:"Description",vi:"Mô tả"}),key:"description",dataIndex:"description",render:(e,t,a)=>i.jsx("p",{style:{width:250},children:e}),sorter:(e,t)=>(e.description||"").localeCompare(t.description||"")},{title:N({en:"Members",vi:"Thành viên"}),key:"membersCount",dataIndex:"membersCount",sorter:(e,t)=>e.membersCount-t.membersCount,render:(e,t,a)=>p(e),align:"end",width:120},{title:N({en:"Actions",vi:"Hành động"}),key:"actions",render:(e,t,a)=>i.jsx(m.Compact,{children:i.jsx(u,{title:N({en:"Bulk Downloader",vi:"Tải hàng loạt"}),children:i.jsx(n,{type:"default",onClick:()=>{return e=t.id,void v("/bulk-downloader",{state:{targetId:e,platform:s.Facebook}});var e},icon:i.jsx("i",{className:"fa-solid fa-download"})})})}),width:100,align:"end"}];return i.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[i.jsxs(m,{direction:"vertical",align:"center",style:{marginBottom:10},children:[A?i.jsx(h,{type:"success",showIcon:!0,message:A===b.MEMBER?N({en:`Joined ${V.length} public groups`,vi:`Đã tham gia ${V.length} nhóm công khai`}):A===b.MUTUAL?N({en:`Joined ${V.length} mutual groups with you`,vi:`Đã tham gia ${V.length} nhóm chung với bạn`}):N({en:`Is admin of ${V.length} groups`,vi:`Là quản trị viên của ${V.length} nhóm`})}):i.jsx(h,{type:"warning",showIcon:!0,message:N({en:"Please select group type to load...",vi:"Vui lòng chọn loại nhóm để tải.."})}),i.jsx(C,{popupMatchSelectWidth:!1,options:Object.entries(k).map((([e,t])=>({label:i.jsxs(i.Fragment,{children:[N(t)," ",t.needVIP&&i.jsxs(j,{color:"warning",children:[i.jsx("i",{className:"fa-solid fa-crown"})," VIP"]})]}),value:e}))),value:A,onChange:M,disabled:S,placeholder:N({en:"Select group type..",vi:"Chọn loại nhóm.."})})]}),A&&i.jsx(E,{columns:J,data:V,keyExtractor:e=>null==e?void 0:e.id,searchable:!0,selectable:!0,pageSize:5,renderTitle:e=>i.jsxs(i.Fragment,{children:[i.jsx(n,{disabled:S,type:"primary",icon:S?i.jsx("i",{className:"fa-solid fa-rotate-right fa-spin"}):i.jsx("i",{className:"fa-solid fa-rotate-right"}),onClick:()=>B(!0),children:N({en:"Reload",vi:"Tải lại"})}),i.jsx(D,{data:e.length?e:V,options:[{key:"uid",label:".txt (id)",prepareData:e=>({fileName:(null==r?void 0:r.name)+"_joined_groups_id.txt",data:e.map((e=>e.id)).join("\n")})},{key:"id_name",label:".csv (id+name)",prepareData:e=>({fileName:(null==r?void 0:r.name)+"_joined_groups_id_name.csv",data:g(e.map((e=>({uid:e.id,name:e.name}))))})},{key:"name_desc",label:".csv (name+desc)",prepareData:e=>({fileName:(null==r?void 0:r.name)+"_joined_groups.csv",data:g(e.map((e=>({name:e.name,desc:e.description}))))})},{key:"json",label:".json",prepareData:e=>({fileName:(null==r?void 0:r.name)+"_joined_groups.json",data:JSON.stringify(e,null,4)})},{key:"csv",label:".csv",prepareData:e=>({fileName:(null==r?void 0:r.name)+"_joined_groups.csv",data:g(e)})}]}),i.jsx(T,{name:"JoinedGroups",text:V.map((e=>{var t,a;return[e.name,null==(a=null==(t=e.description)?void 0:t.replace)?void 0:a.call(t,e.name,"")]})).flat().filter(Boolean).join("\n")})]})})]})}export{L as default};
