const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./getIds-BE6G2xp0.js","./index-DZEcYG8Q.js","./index-C6k8ZUm0.css","./MyApp-DRRa55Bd.js"])))=>i.map(i=>d[i]);
import{aY as e,bj as i,aX as l}from"./index-DZEcYG8Q.js";import{y as o,x as n,W as t,X as r,az as a,aB as _,aC as d,aD as u,aE as s,aF as v,v as c}from"./MyApp-DRRa55Bd.js";import{extractVideoVariants as p}from"./videos-DtjqJObU.js";import"./___vite-browser-external_commonjs-proxy-D5wFEbJ4.js";async function m(i="",l="",t=!1){if(!/^\d+$/.exec(l)){const{getPostIdFromUrl:i}=await e((async()=>{const{getPostIdFromUrl:e}=await import("./getIds-BE6G2xp0.js");return{getPostIdFromUrl:e}}),__vite__mapDeps([0,1,2,3]),import.meta.url);l=await i(l)}const r=await o({fb_api_req_friendly_name:"CometSinglePostContentQuery",variables:{feedbackSource:2,feedLocation:"PERMALINK",focusCommentID:null,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"permalink",scale:2,storyID:L(i,l),useDefaultActor:!1,__relay_internal__pv__CometImmersivePhotoCanUserDisable3DMotionrelayprovider:!1,__relay_internal__pv__IsWorkUserrelayprovider:!1,__relay_internal__pv__IsMergQAPollsrelayprovider:!1,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0,__relay_internal__pv__IncludeCommentWithAttachmentrelayprovider:!0,__relay_internal__pv__StoriesArmadilloReplyEnabledrelayprovider:!0,__relay_internal__pv__EventCometCardImage_prefetchEventImagerelayprovider:!1},doc_id:"8457098094310209"}),a=n(r,[],!0);return console.log(a),await y(a,!0,t)}async function y(e,i=!0,l=!1){var o,t,a,d,u,s,v,c,m,b,C,S;const I=i?["attached_story"]:[],w=r(e,"comment_list_renderer.feedback.comment_rendering_instance_for_feed_location",!0,!1,I),E=r(e,"comet_sections.story.message.text",!0,!1,I)||r(e,"comet_section.message_container.story.message.text",!0,!1,I),F=f(E),R=r(e,"text_format_metadata",!1,!1,I)||[],L=r(e,"attachments.styles.attachment",!0,!1,I),P=null==L?void 0:L.mediaset_token,A=null==L?void 0:L.media,T="Photo"===(null==A?void 0:A.__typename)||"GenericAttachmentMedia"===(null==A?void 0:A.__typename)?A:null,k=null==L?void 0:L.all_subattachments,D=(null==k?void 0:k.nodes)||[],M=((null==k?void 0:k.count)||0)>D.length,O=null==(o=null==L?void 0:L.target)?void 0:o.id,N=D.map((e=>g(e)));if(M&&O){const e=await h(O);for(let i of e){N.find((e=>e.id==i.id))||N.push(i)}}const x="Video"===(null==A?void 0:A.__typename)?A:null,U=r(x,"scrubber_preview_thumbnail_information",!0,!1,I),G=r(e,"story.to",!1,!1,I);let B=[...r(e,"rich_message.entity_ranges",!1,!1,I)||[],...r(e,"story.message.ranges",!1,!1,I)||[]].flat().filter((e=>{var i;return"MENTION"==(null==e?void 0:e.entity_type)||(null==e?void 0:e.entity)&&"Hashtag"!=(null==(i=null==e?void 0:e.entity)?void 0:i.__typename)})).map((e=>{var i,l,o,n,t,r,a,_;const d=(null==(l=null==(i=null==e?void 0:e.entity)?void 0:i.web_link)?void 0:l.url)||(null==(o=null==e?void 0:e.entity)?void 0:o.external_url)||(null==(n=null==e?void 0:e.entity)?void 0:n.url);return{type:null==(t=null==e?void 0:e.entity)?void 0:t.__typename,id:null==(r=null==e?void 0:e.entity)?void 0:r.id,name:(null==(a=null==e?void 0:e.entity)?void 0:a.name)||(null==(_=null==e?void 0:e.entity)?void 0:_.short_name)||d,url:d,length:null==e?void 0:e.length,offset:null==e?void 0:e.offset}}));B=B.filter(((e,i,l)=>i===l.findIndex((i=>i.id===e.id&&i.offset===e.offset))));const H=i?null==(a=null==(t=r(e,"attached_story",!1))?void 0:t.filter)?void 0:a.call(t,Boolean):null;console.log("attached_story",H);const W=r(e,i?"data.node.id":"story.id",!0,!0);let V;try{V=r(e,"data.node.post_id",!0,!0)||(null==(d=atob(W))?void 0:d.split(":").pop())}catch(Q){console.error(Q)}return{id:W,post_id:V,url:r(e,"wwwURL",!0,!1,I)||r(e,"metadata.story.url",!0,!1,I),media:{mediaset_token:P,subAttachments:N,photo:!P&&T?g(T,L):null,video:!P&&x?{id:x.id,url:x.url,thumbnail:(null==(u=x.thumbnailImage)?void 0:u.uri)||(null==(v=null==(s=x.preferred_thumbnail)?void 0:s.image)?void 0:v.uri)||(null==(c=x.image)?void 0:c.uri),duration:x.playable_duration_in_ms||0,width:x.width||0,height:x.height||0,original_width:x.original_width||0,original_height:x.original_height||0,publish_time:1e3*(x.publish_time||0),can_share:x.can_viewer_share,audio_availability:x.audio_availability,is_soundbites_video:x.is_soundbites_video,is_live_streaming:x.is_live_streaming,is_clip:x.is_clip,is_spherical:x.is_spherical,is_looping:x.is_looping,loop_count:x.loop_count,source:{sd:x.browser_native_sd_url,hd:x.browser_native_hd_url,variants:p(x.playlist)},sprite:{uris:(null==U?void 0:U.sprite_uris)||[],thumbnail_width:(null==U?void 0:U.thumbnail_width)||0,thumbnail_height:(null==U?void 0:U.thumbnail_height)||0,num_images_per_row:(null==U?void 0:U.num_images_per_row)||0,max_number_of_images_per_sprite:(null==U?void 0:U.max_number_of_images_per_sprite)||0,time_interval_between_image:(null==U?void 0:U.time_interval_between_image)||1}}:null},text:E,text_format:(null==R?void 0:R.length)?{preset_id:_(R,"preset_id"),background_color:_(R,"background_color"),background_gradient_color:_(R,"background_gradient_color"),background_gradient_direction:_(R,"background_gradient_direction"),background_image:null==(m=_(R,"background_image"))?void 0:m.uri,portrait_background_image:null==(b=_(R,"portrait_background_image"))?void 0:b.uri,color:_(R,"color"),font_weight:_(R,"font_weight"),font_style:_(R,"font_style"),text_align:_(R,"text_align")}:null,hashtags:F,mentions:B,actors:r(e,"comet_sections.story.actors",!0,!1,I)||[],comments:{can_comment:r(e,"can_viewer_comment",!0,!1,I),total:null==(C=null==w?void 0:w.comments)?void 0:C.count,total_count:null==(S=null==w?void 0:w.comments)?void 0:S.total_count,sorting:{selected:null==w?void 0:w.selected_intent,available:null==w?void 0:w.selectable_intents}},reactions:{total:r(e,"comet_ufi_summary_and_actions_renderer.reaction_count.count",!0,!1,I),top:(r(e,"comet_ufi_summary_and_actions_renderer.top_reactions.edges",!0,!1,I)||[]).map((e=>{var i,l;return{id:null==(i=null==e?void 0:e.node)?void 0:i.id,count:null==e?void 0:e.reaction_count,name:null==(l=null==e?void 0:e.node)?void 0:l.localized_name}}))},shares:r(e,"comet_ufi_summary_and_actions_renderer.share_count.count",!0,!1,I),created_time:1e3*(r(e,"metadata.story.creation_time",!0,!1,I)||0),privacy_scope:r(e,"metadata.story.privacy_scope.description",!0,!1,I),copyright_violation_header:r(e,"copyright_violation_header",!0,!1,I),tracking_ids:n(r(e,"call_to_action.tracking",!0,!1,I)),posted_to:G?{type:r(G,"__typename",!0,!1,I),id:r(G,"id",!0,!1,I),url:r(G,"url",!0,!1,I),name:r(G,"name",!0,!1,I),avatar:r(G,"profile_picture.uri",!0,!1,I)}:null,attached_post:(null==H?void 0:H.length)?await y(H,!1):null,raw:l?e:void 0}}function g(e,i){var l,o,n,t,r,a,_,d,u,s,v,c,p,m,y,g;const h=(null==e?void 0:e.media)||e||{},f=(null==(l=h.viewer_image)?void 0:l.width)||(null==(o=h.image)?void 0:o.width),b=(null==(n=h.viewer_image)?void 0:n.height)||(null==(t=h.image)?void 0:t.height);return{id:h.id,url:h.url||(null==e?void 0:e.url)||(null==(_=null==(a=null==(r=null==i?void 0:i.story_attachment_link_renderer)?void 0:r.attachment)?void 0:a.web_link)?void 0:_.url)||`https://fb.com/${h.id}`,uri:(null==(d=h.viewer_image)?void 0:d.uri)||(null==(u=h.photo_image)?void 0:u.uri)||(null==(s=h.image)?void 0:s.uri)||(null==(v=h.large_share_image)?void 0:v.uri),height:(null==(c=h.photo_image)?void 0:c.height)||(null==(p=h.large_share_image)?void 0:p.height)||b,width:(null==(m=h.photo_image)?void 0:m.width)||(null==(y=h.large_share_image)?void 0:y.width)||f,accessibility_caption:h.accessibility_caption||(null==(g=null==i?void 0:i.title_with_entities)?void 0:g.text),accent_color:h.accent_color,real_width:f,real_height:b}}async function h(e){const i=await o({fb_api_req_friendly_name:"MarketplacePDPC2CMediaViewerWithImagesQuery",variables:{targetId:e},doc_id:"10059604367394414"}),l=n(i);return(r(l,"listing_photos",!0)||[]).map((e=>g(e)))}function f(e){const i=[],l=/#(\w+)/g;let o;for(;null!==(o=l.exec(e));)i.push("#"+o[1]);return i}async function b(e="",i=""){const l=await o({fb_api_req_friendly_name:"CometAlbumPhotoCollagePaginationQuery",variables:{cursor:i,count:14,renderLocation:"permalink",scale:2,id:btoa(`mediaset:${e}`)},doc_id:"7250936985006590"}),t=n(l),{edges:r=[],page_info:_={}}=a(t);return console.log("getMediasetContent",t),r.map((e=>{var i,l,o,n,t,r,a,_,d,u,s,v,c,p,m,y,g,h;return{id:null==(i=e.node)?void 0:i.id,image:null==(o=null==(l=e.node)?void 0:l.image)?void 0:o.uri,width:null==(t=null==(n=e.node)?void 0:n.image)?void 0:t.width,height:null==(a=null==(r=e.node)?void 0:r.image)?void 0:a.height,isVideo:"Video"===(null==(_=e.node)?void 0:_.__isMedia),cursor:e.cursor,created_at:1e3*((null==(u=null==(d=e.node)?void 0:d.creation_story)?void 0:u.creation_time)||0),url:null==(v=null==(s=e.node)?void 0:s.creation_story)?void 0:v.url,actors:null==(h=null==(g=null==(y=null==(m=null==(p=null==(c=e.node)?void 0:c.creation_story)?void 0:p.comet_sections)?void 0:m.actor_photo)?void 0:y.story)?void 0:g.actors)?void 0:h.map((e=>{var i;return{id:e.id,name:e.name,url:e.url,avatar:null==(i=e.profile_picture)?void 0:i.uri,type:e.__typename}}))}}))}async function C(e=100,i,o){var t,r,a,_,d;let p="https://graph.facebook.com/v14.0/me/posts?fields=id,reactions.limit(1000){id},comments.limit(1000){from{id}},created_time&limit=100&access_token="+await u(s.FBAndroid);const m=[],y=new Set;for(;;)try{const u=await l(p);v(u);const s=n(u);if(console.log(s),!Array.isArray(null==s?void 0:s.data))break;let g=!1;for(let e of s.data)y.has(e.id)||(g=!0,m.push({postId:e.id,created_time:e.created_time,reactions_uid:null==(r=null==(t=e.reactions)?void 0:t.data)?void 0:r.map((e=>e.id)),comments_uid:null==(_=null==(a=e.comments)?void 0:a.data)?void 0:_.map((e=>e.from.id))}),y.add(e.id));null==i||i(m);const h=null==(d=null==s?void 0:s.paging)?void 0:d.next;if(!g||m.length>=e||h===p||(null==o?void 0:o()))break;p=h,await c(1e3)}catch(g){console.log(g);break}return console.log(m),m}var S=(e=>(e.ALL="ALL",e.SELF="SELF",e.EVERYONE="EVERYONE",e.PUBLIC="PUBLIC",e.FRIENDS="FRIENDS",e.FRIENDS_OF_FRIENDS="FRIENDS_OF_FRIENDS",e.CUSTOM="CUSTOM",e.CLOSED="CLOSED",e))(S||{});const I={ALL:{en:"All",vi:"Tất cả"},EVERYONE:{en:"🌎 Everyone",vi:"🌎 Mọi người"},PUBLIC:{en:"🌎 Public",vi:"🌎 Công khai"},FRIENDS_OF_FRIENDS:{en:"👥 Friends of friends",vi:"👥 Bạn của bạn bè"},FRIENDS:{en:"🫂 Friends",vi:"🫂 Bạn bè"},SELF:{en:"🔒 Only self",vi:"🔒 Chỉ mình tôi"},CUSTOM:{en:"⚙️ Custom",vi:"⚙️ Tuỳ chỉnh"},CLOSED:{en:"🔒 Private group",vi:"🔒 Nhóm riêng tư"}};async function w({cursor:e=null,afterTime:i=null,beforeTime:l=null,omitPinnedPost:r=!0,privacy:a=null,taggedInOnly:_=null,uid:d="",postedByOthers:u=!1}){var s,v,c,p,m,y,g,h,f,b,C,S,I,w,E,R;const L=d||await t(),P=await o({fb_api_req_friendly_name:e?"CometManagePostsFeedRefetchQuery":"ProfileCometManagePostsTimelineRootQuery",variables:{cursor:e,afterTime:i,beforeTime:l?~~(l/1e3):null,gridMediaWidth:230,includeGroupScheduledPosts:!1,includeScheduledPosts:!1,omitPinnedPost:r,postedBy:!1===u?{group:"OWNER"}:!0===u?{group:"NON_OWNER"}:null,privacy:a&&"ALL"!==a?{exclusivity:"EXCLUSIVE",filter:a}:null,privacySelectorRenderLocation:"COMET_STREAM",scale:2,taggedInOnly:_,renderLocation:"timeline",...e?{id:L}:{userID:L},__relay_internal__pv__GHLShouldChangeSponsoredDataFieldNamerelayprovider:!0},doc_id:e?"8847372595369742":"8218825384885789"}),A=n(P,[],!0),T=[r?[]:null==(p=null==(c=null==(v=null==(s=null==A?void 0:A[0])?void 0:s.data)?void 0:v.user)?void 0:c.profile_pinned_post)?void 0:p.pinned_post_story,null==(h=null==(g=null==(y=null==(m=null==A?void 0:A[0])?void 0:m.data)?void 0:y.user)?void 0:g.timeline_manage_feed_units)?void 0:h.edges,null==(S=null==(C=null==(b=null==(f=null==A?void 0:A[0])?void 0:f.data)?void 0:b.node)?void 0:C.timeline_manage_feed_units)?void 0:S.edges,null==(R=null==(E=null==(w=null==(I=null==A?void 0:A.slice)?void 0:I.call(A,1))?void 0:w.filter)?void 0:E.call(w,(e=>{var i;return null==(i=null==e?void 0:e.path)?void 0:i.includes("edges")})))?void 0:R.map((e=>null==e?void 0:e.data))].flat().filter(Boolean).map((e=>(null==e?void 0:e.node)?e:{node:e,cursor:null,isPinned:!0}));return console.log(T),T.map((e=>F(e)))}function E(e){var i,l,o,n,t,r,a,_,d,u,s,v,c,p,m,y,g,h,f;return{id:e.post_id,post_id:e.id,story_id:e.id,url:e.url,creation_time:e.created_time,can_delete:!1,actor:{id:null==(l=null==(i=e.actors)?void 0:i[0])?void 0:l.id,url:null==(n=null==(o=e.actors)?void 0:o[0])?void 0:n.url,name:null==(r=null==(t=e.actors)?void 0:t[0])?void 0:r.name},privacy:{id:e.privacy_scope,scope:e.privacy_scope},content:{text:e.text,attachments:(null==(a=e.media)?void 0:a.photo)?[{id:null==(d=null==(_=e.media)?void 0:_.photo)?void 0:d.id,type:"Photo",thumbnail:null==(s=null==(u=e.media)?void 0:u.photo)?void 0:s.uri}]:(null==(v=e.media)?void 0:v.video)?[{id:null==(p=null==(c=e.media)?void 0:c.video)?void 0:p.id,type:"Video",thumbnail:null==(y=null==(m=e.media)?void 0:m.video)?void 0:y.thumbnail}]:(null==(g=e.media)?void 0:g.subAttachments)?null==(f=null==(h=e.media)?void 0:h.subAttachments)?void 0:f.map((e=>({id:e.id,type:"Photo",thumbnail:e.uri}))):[]},is_pinned:!1,cursor:e.cursor}}function F(e){var i,l,o,n,t,r,a,_,d,u,s,v,c,p,m,y,g,h,f,b,C,S,I,w,E,F,R,L,P,A,T,k,D,M,O,N,x,U,G,B,H,W,V,Q,q,Y,j,$,K,z,X,J,Z,ee,ie,le,oe,ne,te,re,ae,_e,de,ue,se,ve;const ce=null==(t=null==(n=null==(o=null==(l=null==(i=null==e?void 0:e.node)?void 0:i.comet_sections)?void 0:l.actor_photo)?void 0:o.story)?void 0:n.actors)?void 0:t[0],pe=null==(u=null==(d=null==(_=null==(a=null==(r=null==e?void 0:e.node)?void 0:r.comet_sections)?void 0:a.audience)?void 0:_.story)?void 0:d.privacy_scope)?void 0:u.privacy_scope_renderer;return{id:null==(v=atob(null==(s=null==e?void 0:e.node)?void 0:s.id))?void 0:v.split(":").pop(),post_id:(null==(c=null==e?void 0:e.node)?void 0:c.post_id)||(null==(m=atob(null==(p=null==e?void 0:e.node)?void 0:p.id))?void 0:m.split(":").pop()),story_id:null==(y=null==e?void 0:e.node)?void 0:y.id,url:null==(g=null==e?void 0:e.node)?void 0:g.url,message:null==(f=null==(h=null==e?void 0:e.node)?void 0:h.message)?void 0:f.text,title:null==(C=null==(b=null==e?void 0:e.node)?void 0:b.title)?void 0:C.text,summary:null==(I=null==(S=null==e?void 0:e.node)?void 0:S.summary)?void 0:I.text,creation_time:1e3*((null==(w=null==e?void 0:e.node)?void 0:w.creation_time)||0),can_delete:null==(E=null==e?void 0:e.node)?void 0:E.can_viewer_delete,actor:{id:null==ce?void 0:ce.id,url:null==ce?void 0:ce.url,name:null==ce?void 0:ce.name,avatar:null==(F=null==ce?void 0:ce.profile_picture)?void 0:F.uri},privacy:(null==pe?void 0:pe.scope)?{id:null==(L=null==(R=null==pe?void 0:pe.scope)?void 0:R.selected_option)?void 0:L.id,scope:null==(T=null==(A=null==(P=null==pe?void 0:pe.scope)?void 0:P.selected_option)?void 0:A.privacy_row_input)?void 0:T.base_state,can_edit:null==(k=null==pe?void 0:pe.scope)?void 0:k.can_viewer_edit,deny:(null==(O=null==(M=null==(D=null==pe?void 0:pe.scope)?void 0:D.selected_option)?void 0:M.privacy_row_input)?void 0:O.deny)||[],allow:(null==(U=null==(x=null==(N=null==pe?void 0:pe.scope)?void 0:N.selected_option)?void 0:x.privacy_row_input)?void 0:U.allow)||[],label:null==(H=null==(B=null==(G=null==pe?void 0:pe.entry_point_renderer)?void 0:G.source)?void 0:B.scope)?void 0:H.label,description:null==(Q=null==(V=null==(W=null==pe?void 0:pe.entry_point_renderer)?void 0:W.source)?void 0:V.scope)?void 0:Q.description,write_id:null==(q=null==pe?void 0:pe.scope)?void 0:q.privacy_write_id}:{scope:null==(J=null==(X=null==(z=null==(K=null==($=null==(j=null==(Y=null==e?void 0:e.node)?void 0:Y.comet_sections)?void 0:j.audience)?void 0:$.story)?void 0:K.privacy_scope)?void 0:z.icon_image)?void 0:X.name)?void 0:J.toUpperCase(),description:null==(oe=null==(le=null==(ie=null==(ee=null==(Z=null==e?void 0:e.node)?void 0:Z.comet_sections)?void 0:ee.audience)?void 0:ie.story)?void 0:le.privacy_scope)?void 0:oe.description},content:{text:null==(de=null==(_e=null==(ae=null==(re=null==(te=null==(ne=null==e?void 0:e.node)?void 0:ne.attached_story)?void 0:te.comet_sections)?void 0:re.message)?void 0:ae.story)?void 0:_e.message)?void 0:de.text,attachments:[null==(ue=null==e?void 0:e.node)?void 0:ue.attachments,null==(ve=null==(se=null==e?void 0:e.node)?void 0:se.attached_story)?void 0:ve.attachments].filter(Boolean).flat().map((e=>{var i,l,o;const n=null==(i=null==e?void 0:e.style_type_renderer)?void 0:i.attachment;return((null==(l=null==n?void 0:n.all_subattachments)?void 0:l.nodes)||[null==(o=null==e?void 0:e.style_type_renderer)?void 0:o.attachment]).map((e=>{var i,l,o,t,r,a,_,d,u,s;return{id:null==(i=null==e?void 0:e.media)?void 0:i.id,type:null==(l=null==e?void 0:e.media)?void 0:l.__typename,title:null==e?void 0:e.title,thumbnail:(null==(t=null==(o=null==e?void 0:e.media)?void 0:o.image)?void 0:t.uri)||(null==(_=null==(a=null==(r=null==e?void 0:e.media)?void 0:r.preferred_thumbnail)?void 0:a.image)?void 0:_.uri)||(null==(u=null==(d=null==e?void 0:e.media)?void 0:d.fallback_image)?void 0:u.uri),total_count:null==(s=null==n?void 0:n.all_subattachments)?void 0:s.count}}))})).flat().filter((e=>e.thumbnail))},is_pinned:null==e?void 0:e.isPinned,cursor:null==e?void 0:e.cursor}}async function R({writeID:e,baseState:i}){const l=await o({fb_api_req_friendly_name:"CometPrivacySelectorSavePrivacyMutation",variables:{input:{privacy_mutation_token:null,privacy_row_input:{allow:[],base_state:i,deny:[],tag_expansion_state:"UNSPECIFIED"},privacy_write_id:e,render_location:"COMET_STORY_MENU",actor_id:await t()},privacySelectorRenderLocation:"COMET_STORY_MENU",scale:2,storyRenderLocation:"timeline",tags:null,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0},doc_id:"8795472927157290"}),a=n(l);return r(a,"scope.privacy_row_input.base_state")===i}function L(e,i){return btoa(`S:_I${e}:${i}:${i}`)}async function P(e){const i=await o({fb_api_req_friendly_name:"useCometFeedStoryDeleteMutation",variables:{input:{story_id:e,story_location:"PERMALINK",actor_id:await t()},groupID:null,inviteShortLinkKey:null,renderLocation:null,scale:2},doc_id:"9052705268176005"}),l=n(i);return r(l,"deleted_story_id")===e}async function A(e){const i=await o({fb_api_req_friendly_name:"useCometTrashPostMutation",variables:{input:{story_id:e,story_location:"TIMELINE",actor_id:await t()}},doc_id:"5962446683854959"}),l=n(i);return r(l,"trashed_story_id")===e}async function T({uid:e="",startTime:l=i,endTime:o=Date.now(),progress:n}){const t=[];for(;Math.abs(o-l)>864e5;){let i=d(l,o),r=await w({uid:e,beforeTime:i,omitPinnedPost:!0});null==n||n(i,r),(null==r?void 0:r.length)?(o=i-1,t.push(...r)):l=i+1}return t.sort(((e,i)=>e.creation_time-i.creation_time))[0]}var k=(e=>(e.CHRONOLOGICAL="CHRONOLOGICAL",e.RECENT_ACTIVITY="RECENT_ACTIVITY",e.TOP_POSTS="TOP_POSTS",e))(k||{});const D={RECENT_ACTIVITY:{en:"Recent Activity",vi:"Hoạt động gần đây"},CHRONOLOGICAL:{en:"Newest Posts",vi:"Bài viết mới nhất"},TOP_POSTS:{en:"Top Posts",vi:"Bài viết nổi bật"}};async function M({groupId:e,cursor:i="",sorting:l="CHRONOLOGICAL"}){var a,_,d,u,s,v,c,p;const m=i?await o({fb_api_req_friendly_name:"GroupsCometFeedRegularStoriesPaginationQuery",variables:{count:3,cursor:i,feedLocation:"GROUP",feedType:"DISCUSSION",feedbackSource:0,focusCommentID:null,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"group",scale:2,sortingSetting:l,stream_initial_count:1,useDefaultActor:!1,id:e,__relay_internal__pv__GHLShouldChangeAdIdFieldNamerelayprovider:!1,__relay_internal__pv__GHLShouldChangeSponsoredDataFieldNamerelayprovider:!1,__relay_internal__pv__IsWorkUserrelayprovider:!1,__relay_internal__pv__CometFeedStoryDynamicResolutionPhotoAttachmentRenderer_experimentWidthrelayprovider:500,__relay_internal__pv__CometImmersivePhotoCanUserDisable3DMotionrelayprovider:!1,__relay_internal__pv__WorkCometIsEmployeeGKProviderrelayprovider:!1,__relay_internal__pv__IsMergQAPollsrelayprovider:!1,__relay_internal__pv__FBReelsMediaFooter_comet_enable_reels_ads_gkrelayprovider:!1,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0,__relay_internal__pv__StoriesArmadilloReplyEnabledrelayprovider:!0,__relay_internal__pv__EventCometCardImage_prefetchEventImagerelayprovider:!1},doc_id:"28864584756488524"}):await o({fb_api_req_friendly_name:"CometGroupDiscussionRootSuccessQuery",variables:{autoOpenChat:!1,creative_provider_id:null,feedbackSource:0,feedLocation:"GROUP",feedType:"DISCUSSION",focusCommentID:null,groupID:e,hasHoistStories:!1,hoistedSectionHeaderType:"notifications",hoistStories:[],hoistStoriesCount:0,privacySelectorRenderLocation:"COMET_STREAM",regular_stories_count:1,regular_stories_stream_initial_count:1,renderLocation:"group",scale:2,shouldDeferMainFeed:!1,sortingSetting:l,threadID:"",useDefaultActor:!1,__relay_internal__pv__GroupsCometLazyLoadFeaturedSectionrelayprovider:!1,__relay_internal__pv__EventCometCardImage_prefetchEventImagerelayprovider:!1,__relay_internal__pv__GHLShouldChangeAdIdFieldNamerelayprovider:!1,__relay_internal__pv__GHLShouldChangeSponsoredDataFieldNamerelayprovider:!1,__relay_internal__pv__IsWorkUserrelayprovider:!1,__relay_internal__pv__CometFeedStoryDynamicResolutionPhotoAttachmentRenderer_experimentWidthrelayprovider:500,__relay_internal__pv__CometImmersivePhotoCanUserDisable3DMotionrelayprovider:!1,__relay_internal__pv__WorkCometIsEmployeeGKProviderrelayprovider:!1,__relay_internal__pv__IsMergQAPollsrelayprovider:!1,__relay_internal__pv__FBReelsMediaFooter_comet_enable_reels_ads_gkrelayprovider:!1,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0,__relay_internal__pv__StoriesArmadilloReplyEnabledrelayprovider:!0,__relay_internal__pv__GroupsCometGroupChatLazyLoadLastMessageSnippetrelayprovider:!1},doc_id:"9165830940160555"}),y=n(m,{},!0),g=[null==(u=null==(d=null==(_=null==(a=null==y?void 0:y[0])?void 0:a.data)?void 0:_.node)?void 0:d.group_feed)?void 0:u.edges,null==(p=null==(c=null==(v=null==(s=null==y?void 0:y.slice)?void 0:s.call(y,1))?void 0:v.filter)?void 0:c.call(v,(e=>{var i;return null==(i=null==e?void 0:e.path)?void 0:i.includes("edges")})))?void 0:p.map((e=>null==e?void 0:e.data))].flat().filter(Boolean),h=await t();return console.log(g),g.map((i=>{var l,o,n,t,a,_,d,u,s,v,c,p,m,y;const g=r(i,"story.actors",!0),f=(r(i,"metadata",!1)||[]).flat(),b=null==(o=null==(l=f.find((e=>"CometFeedStoryMinimizedTimestampStrategy"===(null==e?void 0:e.__typename))))?void 0:l.story)?void 0:o.creation_time,C=null==(_=null==(a=null==(t=null==(n=f.find((e=>"CometStoryUserSignalsStrategy"===(null==e?void 0:e.__typename))))?void 0:n.story)?void 0:t.user_signals_info)?void 0:a.displayed_user_signals)?void 0:_.map((e=>{var i;return{id:null==e?void 0:e.id,text:null==(i=null==e?void 0:e.title)?void 0:i.text}}));return{id:null==(d=null==i?void 0:i.node)?void 0:d.post_id,post_id:null==(u=null==i?void 0:i.node)?void 0:u.post_id,story_id:null==(s=null==i?void 0:i.node)?void 0:s.id,actor:{id:null==(v=null==g?void 0:g[0])?void 0:v.id,name:null==(c=null==g?void 0:g[0])?void 0:c.name,url:null==(p=null==g?void 0:g[0])?void 0:p.url,signals:C},creation_time:1e3*(b||0),cursor:null==i?void 0:i.cursor,url:r(i,"wwwURL")||r(i,"shareable_from_perspective_of_feed_ufi.url")||`https://www.facebook.com/${e}/posts/${null==(m=null==i?void 0:i.node)?void 0:m.post_id}`,message:r(i,"story.message.text",!0,!0)||(r(i,"rich_message")||[]).map((e=>e.text)).filter(Boolean).join("\n"),title:"",summary:"",privacy:{id:"",scope:r(i,"target_group.visibility")||"PUBLIC",can_edit:!1},can_delete:(null==(y=null==g?void 0:g.some)?void 0:y.call(g,(e=>(null==e?void 0:e.id)===h)))||!1,comments:{total:r(i,"comment_rendering_instance.total_count")||0},reactions:{total:r(i,"comet_ufi_summary_and_actions_renderer.feedback.reaction_count.count")||0,top:(r(i,"comet_ufi_summary_and_actions_renderer.feedback.top_reactions.edges")||[]).map((e=>{var i;return{reactionId:null==(i=null==e?void 0:e.node)?void 0:i.id,count:null==e?void 0:e.reaction_count,icon:null,users:[]}}))},shares:{total:r(i,"share_count.count")||0},content:{text:r(i,"attached_story.message.text",!0),attachments:(r(i,"attachments",!1)||[]).flat().filter(Boolean).map((e=>{var i,l,o,n;const t=r(e,"all_subattachments"),a=r(e,"fb_shorts_story.playback_video")||r(e,"styles.media");return{id:null==a?void 0:a.id,type:(null==a?void 0:a.__typename)||((null==a?void 0:a.length_in_seconds)?"Video":"Photo"),title:(null==a?void 0:a.title)||r(e,"attachment.web_link.url")||r(e,"styles.attachment.title"),thumbnail:r(e,"viewer_image.uri")||(null==(l=null==(i=null==a?void 0:a.preferred_thumbnail)?void 0:i.image)?void 0:l.uri)||(null==(o=null==a?void 0:a.fallback_image)?void 0:o.uri)||(null==(n=null==a?void 0:a.thumbnailImage)?void 0:n.uri)||r(e,"image.uri")||r(e,"large_share_image.uri")||r(e,"contain_fit_image.uri")||r(e,"cropped_image.uri"),total_count:(null==t?void 0:t.count)||1}})).filter((e=>null==e?void 0:e.thumbnail))}}})).filter((e=>null==e?void 0:e.id))}async function O(e){const i=await o({fb_api_req_friendly_name:"CometFeedStoryMenuQuery",variables:{feed_location:"TIMELINE",feed_menu_icon_variant:"FILLED",id:e,scale:2,serialized_frtp_identifiers:null,story_debug_info:null,__relay_internal__pv__CometFeedStoryCopyLinkMenuItem_isLinkSharingEnabledrelayprovider:!0,__relay_internal__pv__FBReels_deprecate_short_form_video_context_gkrelayprovider:!0},doc_id:"24072660595660601"});return n(i)}function N(e,i="UNTAG"){var l,o,n,t,r;return null==(r=null==(t=null==(n=null==(o=null==(l=null==e?void 0:e.data)?void 0:l.feed_unit)?void 0:o.nfx_action_menu_items)?void 0:n.find((e=>{var l;return(null==(l=null==e?void 0:e.action)?void 0:l.type)==i})))?void 0:t.action)?void 0:r.context}async function x(e){const i=await O(e),l=N(i,"UNTAG");if(console.log(i,l),!l)return!1;const a=await o({fb_api_req_friendly_name:"CometFeedStoryExecuteNFXActionMutation",variables:{input:{context:l,type:"UNTAG",actor_id:await t(),client_mutation_id:"1"},scale:2},doc_id:"29865610506387006"}),_=n(a);return console.log(_),"UNTAG"===r(_,"executed_action.type")||"UNTAG"===r(_,"action_path")}async function U({uid:e,text:i,cursor:l=null}){const t=l?await o({fb_api_req_friendly_name:"SearchCometResultsPaginatedResultsQuery",variables:{allow_streaming:!1,args:{callsite:"comet:scoped:user",config:{exact_match:!1,high_confidence_config:null,intercept_config:null,sts_disambiguation:null,watch_config:null},experience:{client_defined_experiences:["ADS_PARALLEL_FETCH"],encoded_server_defined_params:null,fbid:e,type:"PROFILE_SCOPED"},filters:[],text:i},count:5,cursor:l,feedLocation:"SEARCH",feedbackSource:23,fetch_filters:!0,focusCommentID:null,locale:null,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"search_results_page",scale:2,stream_initial_count:0,useDefaultActor:!1,__relay_internal__pv__GHLShouldChangeAdIdFieldNamerelayprovider:!0,__relay_internal__pv__GHLShouldChangeSponsoredDataFieldNamerelayprovider:!0,__relay_internal__pv__IsWorkUserrelayprovider:!1,__relay_internal__pv__FBReels_deprecate_short_form_video_context_gkrelayprovider:!0,__relay_internal__pv__FeedDeepDiveTopicPillThreadViewEnabledrelayprovider:!1,__relay_internal__pv__FBReels_enable_view_dubbed_audio_type_gkrelayprovider:!1,__relay_internal__pv__CometImmersivePhotoCanUserDisable3DMotionrelayprovider:!1,__relay_internal__pv__WorkCometIsEmployeeGKProviderrelayprovider:!1,__relay_internal__pv__IsMergQAPollsrelayprovider:!1,__relay_internal__pv__FBReelsMediaFooter_comet_enable_reels_ads_gkrelayprovider:!0,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0,__relay_internal__pv__CometUFI_dedicated_comment_routable_dialog_gkrelayprovider:!1,__relay_internal__pv__StoriesArmadilloReplyEnabledrelayprovider:!0,__relay_internal__pv__FBReelsIFUTileContent_reelsIFUPlayOnHoverrelayprovider:!0},doc_id:"31218361541088209"}):await o({fb_api_req_friendly_name:"SearchCometResultsInitialResultsQuery",variables:{count:5,allow_streaming:!1,args:{callsite:"comet:scoped:user",config:{exact_match:!1,high_confidence_config:null,intercept_config:null,sts_disambiguation:null,watch_config:null},experience:{client_defined_experiences:["ADS_PARALLEL_FETCH"],encoded_server_defined_params:null,fbid:e,type:"PROFILE_SCOPED"},filters:[],text:i},cursor:l,feedbackSource:23,fetch_filters:!0,renderLocation:"search_results_page",scale:2,stream_initial_count:0,useDefaultActor:!1,__relay_internal__pv__GHLShouldChangeAdIdFieldNamerelayprovider:!0,__relay_internal__pv__GHLShouldChangeSponsoredDataFieldNamerelayprovider:!0,__relay_internal__pv__IsWorkUserrelayprovider:!1,__relay_internal__pv__FBReels_deprecate_short_form_video_context_gkrelayprovider:!0,__relay_internal__pv__FeedDeepDiveTopicPillThreadViewEnabledrelayprovider:!1,__relay_internal__pv__FBReels_enable_view_dubbed_audio_type_gkrelayprovider:!1,__relay_internal__pv__CometImmersivePhotoCanUserDisable3DMotionrelayprovider:!1,__relay_internal__pv__WorkCometIsEmployeeGKProviderrelayprovider:!1,__relay_internal__pv__IsMergQAPollsrelayprovider:!1,__relay_internal__pv__FBReelsMediaFooter_comet_enable_reels_ads_gkrelayprovider:!0,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0,__relay_internal__pv__CometUFI_dedicated_comment_routable_dialog_gkrelayprovider:!1,__relay_internal__pv__StoriesArmadilloReplyEnabledrelayprovider:!0,__relay_internal__pv__FBReelsIFUTileContent_reelsIFUPlayOnHoverrelayprovider:!0},doc_id:"24551583271142639"}),_=n(t,[],!0);console.log(_);const{edges:d=[],page_info:u={}}=a(_)||{},s=[];for(let o of d){const e=r(o,"rendering_strategy.story"),i=await y(e);i.id=null==e?void 0:e.id,i.post_id=null==e?void 0:e.post_id,i.cursor=(null==o?void 0:o.cursor)||(null==u?void 0:u.end_cursor);const l=E(i);console.log(l),s.push(l)}return s}export{k as GroupPostSorting,D as GroupPostSortingName,S as PrivacyScope,I as PrivacyScopeName,E as convertPostContentToPostData,L as convetPostIdToStoryId,P as deletePost,N as extractContextFromFeedMenu,f as extractHashtags,F as extractPost,y as extractPostContent,T as findFirstPost,h as getAllSubAttachments,O as getFeedMenu,M as getGroupPosts,b as getMediasetContent,m as getPostContent,w as getPosts,C as getPostsInteractions,U as searchAllPostsOnFB,R as setPostPrivacy,A as trashPost,x as unTagPost};
