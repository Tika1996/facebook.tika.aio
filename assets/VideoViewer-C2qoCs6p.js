const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./VideoWithMuted-BryCN2DG.js","./index-DZEcYG8Q.js","./index-C6k8ZUm0.css","./AudioWithMuted-Dy8408YA.js","./MyApp-DRRa55Bd.js","./FileSaver.min-w2jMQ0tn.js"])))=>i.map(i=>d[i]);
import{r as e,d4 as i,b1 as t,b5 as n,aY as o,b2 as s}from"./index-DZEcYG8Q.js";import{getVideoInfo as a}from"./videos-DtjqJObU.js";import{u as r,S as l,T as c,aZ as d,ah as u,I as m}from"./MyApp-DRRa55Bd.js";import"./___vite-browser-external_commonjs-proxy-D5wFEbJ4.js";const h=s((()=>o((()=>import("./VideoWithMuted-BryCN2DG.js")),__vite__mapDeps([0,1,2]),import.meta.url)),{fallback:m}),p=s((()=>o((()=>import("./AudioWithMuted-Dy8408YA.js")),__vite__mapDeps([3,1,2]),import.meta.url)),{fallback:m});function f({info:s,style:m,videoStyle:f,buttonTop:v=!1,getVideoInfoFn:j=a,defaultVariantTitle:x={en:"Default",vi:"Mặc định"},forceGetVideoInfo:y=!1}){var _;const{ti:g}=r(),[w,b]=e.useState(null),[k,A]=e.useState({}),[C,E]=e.useState(0),[V,R]=e.useState(!1),[I,T]=e.useState(s),L=(null==I?void 0:I.variants)||s.variants||[],O=(null==w?void 0:w.source)||(null==I?void 0:I.source),S=(null==I?void 0:I.url)||(null==s?void 0:s.url);e.useEffect((()=>{(!s.source||y)&&s.id&&j?(R(!0),j(s.id).then((e=>{T(e)})).finally((()=>{R(!1)}))):T(s)}),[s.source,s.id,j]);const D=e.useRef(!1);e.useEffect((()=>{!(null==L?void 0:L.length)||Object.keys(k).length||D.current||(D.current=!0,Promise.all(L.map((e=>i(e.source).then((({url:i,size:t})=>{A((i=>({...i,[e.id]:t})))})).catch((()=>{console.log("ERROR get size",e)}))))).finally((()=>{D.current=!1})))}),[k,L]),e.useEffect((()=>{O&&i(O).then((({url:e,size:i})=>{E(i)}))}),[O]);const M=t.jsxs(l.Compact,{style:{maxWidth:600,flexWrap:"wrap",justifyContent:"center"},children:[t.jsx(c,{title:C?d(C,1):"",children:t.jsx(n,{type:w?"default":"primary",onClick:()=>b(null),children:g(x)})}),null==L?void 0:L.map(((e,i)=>t.jsx(c,{title:(e.isAudio?"":e.width+"x"+e.height)+(k[e.id]?" - "+d(k[e.id],1):""),children:t.jsxs(n,{type:(null==w?void 0:w.id)===e.id?"primary":"default",onClick:async()=>{b(e);const{trackEvent:i}=await o((async()=>{const{trackEvent:e}=await import("./MyApp-DRRa55Bd.js").then((e=>e.b1));return{trackEvent:e}}),__vite__mapDeps([4,1,2]),import.meta.url);i("VideoViewer:onChangeVariant:"+(e.qualityLabel||e.mimeType))},icon:e.isAudio?t.jsx("i",{className:"fa-solid fa-music"}):null,children:[e.qualityClass," ",e.qualityLabel||e.mimeType]})},e.id)))]});return t.jsxs(l,{direction:"vertical",style:{padding:15,borderRadius:10,backgroundColor:"#222",justifyContent:"center",alignItems:"center",overflowY:"auto",...m},children:[!V&&v&&M,V?t.jsx(u,{tip:g({en:"Loading video...",vi:"Đang tải video..."}),children:t.jsx("div",{style:{width:150,height:50}})}):null,(null==w?void 0:w.isAudio)?t.jsx(p,{src:O}):O?t.jsx(h,{src:O,style:{maxWidth:"90vw",maxHeight:"70vh",borderRadius:10,...f},children:null==(_=null==w?void 0:w.urls)?void 0:_.map(((e,i)=>t.jsx("source",{src:e},i)))}):null,O&&t.jsxs(l.Compact,{children:[t.jsx(c,{placement:"bottom",title:t.jsxs(t.Fragment,{children:[g({en:"If cannot download, try open FB_AIO in ",vi:"Nếu không tải được, hãy thử mở FB_AIO bằng "}),t.jsxs("a",{href:"https://coccoc.com/",target:"_blank",style:{color:"inherit",textDecoration:"underline"},children:[g({en:"Coc Coc Browser",vi:"Trình duyệt Cốc Cốc"})," ",t.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"})]})]}),children:t.jsx(n,{icon:t.jsx("i",{className:"fa-solid fa-download"}),onClick:async()=>{const{saveAs:e}=await o((async()=>{const{saveAs:e}=await import("./FileSaver.min-w2jMQ0tn.js").then((e=>e.F));return{saveAs:e}}),__vite__mapDeps([5,1,2]),import.meta.url);e(O,(null==w?void 0:w.isAudio)?"audio.mp3":"video.mp4")},children:g({en:"Download",vi:"Tải xuống"})})}),t.jsx(c,{title:g({en:"Open Video in new tab",vi:"Mở Video trong tab mới"}),children:t.jsx(n,{icon:t.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"}),onClick:()=>window.open(O,"_blank","noreferrer,noopener"),children:"Video"})}),S&&t.jsx(c,{title:g({en:"Open URL",vi:"Mở URL"}),children:t.jsx(n,{icon:t.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"}),onClick:()=>window.open(S,"_blank"),children:"URL"})})]}),!V&&!v&&M]})}export{f as default};
