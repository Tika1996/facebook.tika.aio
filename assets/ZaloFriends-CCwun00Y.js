import{r as e,b1 as t,b5 as i}from"./index-DZEcYG8Q.js";import n from"./MyTable-D1FbPMwN.js";import{u as r,S as a,c as l,b as s,q as o,f as d,e as c,T as h,A as m,s as v,o as u}from"./MyApp-DRRa55Bd.js";import p from"./ExportButton-CPuYvz9B.js";import{I as x}from"./index-BE0FsmaM.js";import"./index-BA5m7QhG.js";import"./index-DOt91uSA.js";import"./DownOutlined-BrkIPj-I.js";import"./Table-DDck-vB7.js";import"./addEventListener-C9VBchln.js";import"./List-BPJoeCz4.js";import"./index-BRk8JeT5.js";import"./index-CEGXIRel.js";import"./index-BQAhaSn9.js";import"./index-KPoWFIyW.js";import"./dropdown-BoVCRztz.js";import"./Dropdown-BgvXKd3u.js";import"./PurePanel-Beni9Vkb.js";import"./move-Bzyc79vL.js";import"./index-D9U4WvIE.js";import"./index-CvALG2oX.js";import"./SearchOutlined-Bh66KhXc.js";import"./useBreakpoint-HjQEkdEA.js";import"./Pagination-Dv2YSLQ3.js";import"./Input-LTpJ6AuY.js";import"./row-BgRGnxnv.js";import"./index-B87p3I4c.js";import"./EyeOutlined-BBPXKIU8.js";import"./useVIP-CGpIDALh.js";import"./sweetalert2.esm.all-BZxvatOx.js";import"./getIds-BE6G2xp0.js";import"./index-CiDxWY8X.js";var f=(e=>(e[e.Male=0]="Male",e[e.Female=1]="Female",e))(f||{});const b={0:{color:"blue",en:"Male",vi:"Nam"},1:{color:"pink",en:"Female",vi:"Nữ"}};function j({friends:j,onReload:g,onOpenChat:y}){const{ti:T}=r(),N=e.useMemo((()=>{const e=new Set(j.map((e=>e.cover))),t=new Map(Array.from(e).map((e=>[e,j.filter((t=>t.cover===e)).length])));return Array.from(t.entries()).filter((([e,t])=>t>1)).map((([e,t])=>({text:e+" ("+t+")",value:e})))}),[j]),I=e.useMemo((()=>{const e=j.map((e=>{var t;return null==(t=e.birthday)?void 0:t.year})).filter((e=>e));return[...new Set(e)].map((t=>({year:t,count:e.filter((e=>e===t)).length}))).sort(((e,t)=>t.year-e.year)).map((e=>({text:e.year+" ("+e.count+")",value:"y"+e.year})))}),[j]),k=e.useMemo((()=>{const e=j.map((e=>{var t;return null==(t=e.birthday)?void 0:t.month})).filter((e=>e));return[...new Set(e)].map((t=>({month:t,count:e.filter((e=>e===t)).length}))).sort(((e,t)=>e.month-t.month)).map((e=>({text:T({en:"Month "+e.month,vi:"Tháng "+e.month})+" ("+e.count+")",value:"m"+e.month})))}),[j,T]),w=[{title:"#",dataIndex:"index",key:"index",sorter:(e,t)=>e.index-t.index,width:50,fixed:"left"},{title:T({en:"Cover",vi:"Ảnh bìa"}),dataIndex:"cover",key:"cover",render:(e,i,n)=>t.jsx(x,{src:i.cover,width:100,height:100,style:{borderRadius:10,objectFit:"cover"}}),filters:N,onFilter:(e,t)=>t.cover===e,width:130},{title:T({en:"User",vi:"Người dùng"}),dataIndex:"user",key:"user",render:(e,i,n)=>t.jsxs(a,{children:[t.jsx(x,{src:i.avatar,width:60,height:60,style:{borderRadius:30}}),t.jsxs(a,{direction:"vertical",size:0,children:[t.jsx(l.Link,{onClick:()=>{null==y||y(i)},children:i.displayName}),i.zaloName&&i.zaloName!==i.displayName?t.jsx(l.Text,{type:"secondary",children:i.zaloName}):null]})]}),sorter:(e,t)=>e.displayName.localeCompare(t.displayName),width:230,fixed:"left"},{title:T({en:"Bio",vi:"Bio"}),dataIndex:"status",filters:[{text:T({en:"Has bio",vi:"Có bio"})+" ("+j.filter((e=>!!e.status)).length+")",value:!0},{text:T({en:"No bio",vi:"Không bio"})+" ("+j.filter((e=>!e.status)).length+")",value:!1}],onFilter:(e,t)=>e?!!t.status:!t.status,width:200},{title:T({en:"Business",vi:"Doanh nghiệp"}),dataIndex:"bizInfo",key:"bizInfo",render:(e,i,n)=>{var r,o,d;return(null==(r=i.bizInfo)?void 0:r.pkgId)?t.jsxs(a,{direction:"vertical",style:{maxWidth:300},size:4,children:[t.jsx(s,{color:"blue",children:T({en:null==(o=i.bizInfo.label)?void 0:o.EN,vi:null==(d=i.bizInfo.label)?void 0:d.VI})}),Object.entries(i.bizInfo.biz||{}).map((([e,i])=>!!i&&t.jsxs(l.Text,{children:[t.jsx(s,{children:e})," ",i]},e)))]}):t.jsx("div",{style:{width:100},children:"-"})},filters:[{text:T({en:"Business",vi:"Doanh nghiệp"})+" ("+j.filter((e=>{var t;return!!(null==(t=e.bizInfo)?void 0:t.pkgId)})).length+")",value:!0},{text:T({en:"No business",vi:"Không doanh nghiệp"})+" ("+j.filter((e=>{var t;return!(null==(t=e.bizInfo)?void 0:t.pkgId)})).length+")",value:!1}],onFilter:(e,t)=>{var i,n;return e?!!(null==(i=t.bizInfo)?void 0:i.pkgId):!(null==(n=t.bizInfo)?void 0:n.pkgId)}},{title:T({en:"Phone",vi:"Số điện thoại"}),dataIndex:"phoneNumber",key:"phoneNumber",filters:[{text:T({en:"Has phone",vi:"Có SĐT"})+" ("+j.filter((e=>!!e.phoneNumber)).length+")",value:!0},{text:T({en:"No phone",vi:"Không SĐT"})+" ("+j.filter((e=>!e.phoneNumber)).length+")",value:!1}],onFilter:(e,t)=>e?!!t.phoneNumber:!t.phoneNumber,width:130},{title:T({en:"Gender",vi:"Giới tính"}),dataIndex:"gender",key:"gender",render:(e,i,n)=>{const r=b[i.gender];return t.jsx(s,{color:(null==r?void 0:r.color)||"default",children:(null==r?void 0:r.vi)||i.gender})},filters:[{text:T({en:"Male",vi:"Nam"})+" ("+j.filter((e=>e.gender===f.Male)).length+")",value:f.Male},{text:T({en:"Female",vi:"Nữ"})+" ("+j.filter((e=>e.gender===f.Female)).length+")",value:f.Female}],onFilter:(e,t)=>t.gender===e,width:100},{title:T({en:"Birthday",vi:"Ngày sinh"}),dataIndex:"dob",key:"dob",render:(e,i,n)=>{if(i.dob){const e=new Date(1e3*i.dob),n=o(e.getFullYear(),e.getMonth(),e.getDate());return t.jsxs(a,{direction:"vertical",size:3,children:[t.jsxs(s,{color:"blue",children:[n," ",T({en:"years",vi:"tuổi"})]}),d(e.getTime(),{hour:void 0,minute:void 0})]})}return i.sdob?i.sdob:"-"},filters:[{text:T({en:"No birthday",vi:"Không có ngày sinh"})+" ("+j.filter((e=>!e.dob&&!e.sdob)).length+")",value:-1},{text:T({en:"Know date/month",vi:"Biết ngày/tháng"})+" ("+j.filter((e=>!e.dob&&!!e.sdob)).length+")",value:"date/month"},{text:T({en:"Know age",vi:"Biết tuổi"})+" ("+j.filter((e=>!!e.dob)).length+")",value:"age"},...k,...I],onFilter:(e,t)=>{var i,n,r,a,l;return-1===e?!t.birthday:"date/month"===e?!!(null==(i=t.birthday)?void 0:i.month)&&!!(null==(n=t.birthday)?void 0:n.day):"age"===e?!!(null==(r=t.birthday)?void 0:r.year):"string"==typeof e&&e.startsWith("m")?(null==(a=t.birthday)?void 0:a.month)===parseInt(e.slice(1)):!("string"!=typeof e||!e.startsWith("y"))&&(null==(l=t.birthday)?void 0:l.year)===parseInt(e.slice(1))},width:130},{title:T({en:"Platform",vi:"Nền tảng"}),dataIndex:"isActive",key:"isActive",render:(e,i,n)=>t.jsxs(a,{direction:"vertical",size:3,children:[t.jsxs(s,{color:i.isActive?"success":"error",children:[t.jsx("i",{className:"fa-solid fa-"+(i.isActive?"check":"xmark")})," ",T({en:"Mobile",vi:"Điện thoại"})]}),t.jsxs(s,{color:i.isActivePC?"success":"error",children:[t.jsx("i",{className:"fa-solid fa-"+(i.isActivePC?"check":"xmark")})," ",T({en:"PC",vi:"PC"})]}),t.jsxs(s,{color:i.isActiveWeb?"success":"error",children:[t.jsx("i",{className:"fa-solid fa-"+(i.isActiveWeb?"check":"xmark")})," ",T({en:"Web",vi:"Web"})]})]}),width:120,filters:[{text:T({en:"Mobile",vi:"Điện thoại"})+" ("+j.filter((e=>e.isActive)).length+")",value:!0},{text:T({en:"No Mobile",vi:"Không điện thoại"})+" ("+j.filter((e=>!e.isActive)).length+")",value:!1},{text:T({en:"PC",vi:"PC"})+" ("+j.filter((e=>e.isActivePC)).length+")",value:"pc"},{text:T({en:"Web",vi:"Web"})+" ("+j.filter((e=>e.isActiveWeb)).length+")",value:"web"}],onFilter:(e,t)=>"pc"===e?!!t.isActivePC:"web"===e?!!t.isActiveWeb:t.isActive==e},{title:T({en:"Last online",vi:"Online"}),dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:(e,i,n)=>i.lastOnlineTime?t.jsxs(a,{direction:"vertical",size:0,children:[c(i.lastOnlineTime)+T({en:" ago",vi:" trước"}),t.jsx("span",{style:{opacity:.5},children:d(i.lastOnlineTime)})]}):"-",sorter:(e,t)=>(e.lastOnlineTime||0)-(t.lastOnlineTime||0),width:120,filters:[{text:T({en:"Has data",vi:"Có dữ liệu"})+" ("+j.filter((e=>!!e.lastOnlineTime)).length+")",value:!0},{text:T({en:"No data",vi:"Không dữ liệu"})+" ("+j.filter((e=>!e.lastOnlineTime)).length+")",value:!1}],onFilter:(e,t)=>e?!!t.lastOnlineTime:!t.lastOnlineTime},{title:T({en:"Last action",vi:"Hoạt động"}),dataIndex:"lastActionTime",key:"lastActionTime",render:(e,i,n)=>i.lastActionTime?t.jsxs(a,{direction:"vertical",size:0,children:[c(i.lastActionTime)+T({en:" ago",vi:" trước"}),t.jsx("span",{style:{opacity:.5},children:d(i.lastActionTime)})]}):"-",sorter:(e,t)=>e.lastActionTime-t.lastActionTime,width:120},{title:T({en:"Last update",vi:"Cập nhật"}),dataIndex:"lastUpdateTime",key:"lastUpdateTime",render:(e,i,n)=>i.lastUpdateTime?t.jsxs(a,{direction:"vertical",size:0,children:[c(1e3*i.lastUpdateTime)+T({en:" ago",vi:" trước"}),t.jsx("span",{style:{opacity:.5},children:d(1e3*i.lastUpdateTime)})]}):"-",sorter:(e,t)=>e.lastUpdateTime-t.lastUpdateTime,width:120},{title:T({en:"Created",vi:"Ngày tạo"}),dataIndex:"createdTs",key:"createdTs",render:(e,i,n)=>i.createdTs?t.jsxs(a,{direction:"vertical",size:0,children:[c(1e3*i.createdTs),t.jsx("span",{style:{opacity:.5},children:d(1e3*i.createdTs)})]}):"-",sorter:(e,t)=>e.createdTs-t.createdTs,filters:[{text:T({en:"Has created",vi:"Có ngày tạo"})+" ("+j.filter((e=>!!e.createdTs)).length+")",value:!0},{text:T({en:"No created",vi:"Không ngày tạo"})+" ("+j.filter((e=>!e.createdTs)).length+")",value:!1}],onFilter:(e,t)=>e?!!t.createdTs:!t.createdTs,width:120},{title:T({en:"Action",vi:"Hành động"}),dataIndex:"action",key:"action",render:(e,n,r)=>t.jsx(a,{children:t.jsx(h,{title:T({en:"Open chat",vi:"Mở cuộc trò chuyện"}),children:t.jsx(i,{icon:t.jsx("i",{className:"fa-solid fa-message"}),onClick:()=>{null==y||y(n)}})})}),width:120}];return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10,alignItems:"center",justifyContent:"center",maxWidth:"100%"},children:[t.jsx(m,{showIcon:!0,type:"info",message:T({en:"Discussion on Facebook",vi:"Bàn luận trên Facebook"}),action:t.jsxs("a",{href:"https://www.facebook.com/groups/fbaio/posts/1739720623349285",target:"_blank",style:{marginLeft:5},children:[T({en:"Read more",vi:"Xem thêm"})," ",t.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"})]})}),t.jsx(n,{searchable:!0,onSearchRow:(e,t)=>{var i;return v(e,t.displayName+t.zaloName+t.status+t.phoneNumber+Object.values((null==(i=t.bizInfo)?void 0:i.biz)||{}).join(" "))},data:j,columns:w,renderTitle:e=>t.jsxs(a,{children:[t.jsx(i,{icon:t.jsx("i",{className:"fa-solid fa-rotate-right"}),onClick:g,children:T({en:"Reload",vi:"Tải lại"})}),t.jsx(p,{data:j,options:[{key:"json",label:".json",prepareData:e=>({fileName:"zalo-friends.json",data:JSON.stringify(e,null,4)})},{key:"csv",label:".csv",prepareData:e=>({fileName:"zalo-friends.csv",data:u(e.map((e=>{var t,i,n,r;return{...e,birthday:e.birthday?[null==(t=e.birthday)?void 0:t.year,null==(i=e.birthday)?void 0:i.month,null==(n=e.birthday)?void 0:n.day].filter(Boolean).join("-"):"",bizInfo:Object.entries((null==(r=e.bizInfo)?void 0:r.biz)||{}).map((([e,t])=>e+": "+t)).join(", ")}})))})}]})]})})]})}export{j as default};
