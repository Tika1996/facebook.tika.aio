const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./photos-O1XM4ehS.js","./MyApp-DRRa55Bd.js","./index-DZEcYG8Q.js","./index-C6k8ZUm0.css","./videos-DtjqJObU.js","./___vite-browser-external_commonjs-proxy-D5wFEbJ4.js","./comments-Dt_w-TDU.js","./reactions-DA-LA4iH.js","./posts-DYhkBr35.js"])))=>i.map(i=>d[i]);
import{aY as t,bp as e,aX as n}from"./index-DZEcYG8Q.js";import{y as i,x as o,X as r}from"./MyApp-DRRa55Bd.js";const a={urlToId:{},videoIdToPostId:{}};async function s(t,e){try{if(a.urlToId[t])return a.urlToId[t];let i=await n(t);if(i)for(const n of e){let e=n.exec(i);if(null==e?void 0:e.length)return a.urlToId[t]=e[0],e[0]}}catch(i){}return null}async function l(n,i=!0){var o,r,a,d,u,f,_,p;if(/^\d+$/.test(n))return n;n.includes("https")||n.includes("/")||(n=`https://fb.com/${n}`);const m=null==(o=/\?profile_id=(\d+)/.exec(n))?void 0:o[1];if(m)return m;const v=null==(r=/\/groups\/(\d+)\/user\/(\d+)/.exec(n))?void 0:r[2];if(v)return v;const w=null==(a=/groups\/(\d+)/.exec(n))?void 0:a[1];if(w)return w;const h=null==(d=/profile.php\?id=(\d+)/.exec(n))?void 0:d[1];if(h)return h;if(n.includes("story_fbid=")){const t=new URLSearchParams(n.split("?")[1]);if(t.has("id"))return t.get("id")}const y=null==(u=/facebook.com\/(.*?)\/posts\//.exec(n))?void 0:u[1];y&&(n=`https://www.facebook.com/${y}`);if(null==(f=/\/groups\/([^\/]+)/.exec(n))?void 0:f[1]){let t=n;return n.includes("/permalink/")&&(t=n.split("/permalink/")[0]),await s(t,[new RegExp('(?<="groupID":")(.\\d+?)(?=")')])}if(n.includes("/photo")&&n.includes("fbid=")){const e=null==(_=/fbid=(\d+)/.exec(n))?void 0:_[1],{getBasicPhotoInfo:i}=await t((async()=>{const{getBasicPhotoInfo:t}=await import("./photos-O1XM4ehS.js");return{getBasicPhotoInfo:t}}),__vite__mapDeps([0,1,2,3]),import.meta.url),o=null==(p=(await i(e)).owner)?void 0:p.id;if(o)return o}if(i){const t=await e(n);if(t&&t!==n)return await l(t,!1)}const I=await s(n,[new RegExp('(?<="userID":")(.\\d+?)(?=")')]);if(I)return I;const g=await c(n);if(g){const{getVideoInfo:e}=await t((async()=>{const{getVideoInfo:t}=await import("./videos-DtjqJObU.js");return{getVideoInfo:t}}),__vite__mapDeps([4,5,2,3,1]),import.meta.url),n=await e(g);if(null==n?void 0:n.owner)return n.owner}return null}function d(t){if(/^\d+$/.test(t))return t;if(t.includes("comment_id=")){const e=new URLSearchParams(t.split("?")[1]).get("comment_id");if(e)return e}return null}async function c(n,i=!0){var o,r,a,s,f,_,p,m;if(/^\d+$/.test(n))return n;const v=d(n);if(v){const{getCommentInfoFromId:e,CommentAttachmentType:n}=await t((async()=>{const{getCommentInfoFromId:t,CommentAttachmentType:e}=await import("./comments-Dt_w-TDU.js");return{getCommentInfoFromId:t,CommentAttachmentType:e}}),__vite__mapDeps([6,1,2,3,4,5,7]),import.meta.url),i=await e(v),r=null==(o=null==i?void 0:i.attachments)?void 0:o.find((t=>t.type===n.VIDEO));if(r)return r.video.id}const w=null==(r=/share_url=(.*?)v=(\d+)/.exec(n))?void 0:r[2];if(w)return w;const h=null==(a=/\/watch[\/]?\?v=(\d+)/.exec(n))?void 0:a[1];if(h)return h;const y=null==(s=/\/videos\/(\d+)/.exec(n))?void 0:s[1];if(y)return y;const I=null==(f=/\/reel\/(\d+)/.exec(n))?void 0:f[1];if(I)return I;const g=null==(_=/\/watch\/\?(.*?)v=(\d+)/.exec(n))?void 0:_[2];if(g)return g;if(i){const t=await e(n);if(t&&t!==n)return await c(t,!1)}const x=await u(n,!1,!1);if(x){const e=await l(n);if(e){const{getPostContent:n}=await t((async()=>{const{getPostContent:t}=await import("./posts-DYhkBr35.js");return{getPostContent:t}}),__vite__mapDeps([8,2,3,1,4,5]),import.meta.url),i=await n(e,x);if(null==(m=null==(p=i.media)?void 0:p.video)?void 0:m.id)return i.media.video.id}}return null}async function u(t,n=!0,i=!0){var o,r,a,s,l,d,f;if(/^\d+$/.test(t))return t;let _=null==(o=/\/posts\/(\d+)/.exec(t))?void 0:o[1];if(_)return _;let v=null==(r=/\/posts\/(pfbid\w+)/.exec(t))?void 0:r[1];if(v)return await p(v);const w=null==(a=/\/pending_posts\/(\d+)/.exec(t))?void 0:a[1];if(w)return w;if(t.includes("story_fbid=")){const e=new URLSearchParams(t.split("?")[1]);if(e.has("story_fbid")&&e.has("id")){const t=e.get("story_fbid");if(t.match(/^pfbid/))return await p(t);if(t.match(/^\d+/))return t}}if(t.includes("multi_permalinks=")){const e=new URLSearchParams(t.split("?")[1]);if(e.has("multi_permalinks"))return e.get("multi_permalinks")}if(t.includes("/permalink/")&&t.includes("/groups/")){const e=null==(s=/\/permalink\/(\d+)/.exec(t))?void 0:s[1];if(e)return e}if(t.includes("/photo/")){const e=new URLSearchParams(t.split("?")[1]);if(e.has("fbid"))return e.get("fbid")}const h=null==(l=/\/groups\/(.*?)\/posts\/(\d+)\//.exec(t))?void 0:l[2];if(h)return h;const y=null==(d=/\/posts\/(.*?)\/(\d+)/.exec(t))?void 0:d[2];if(y)return y;const I=null==(f=/\?fbid=(\d+)/.exec(t))?void 0:f[1];if(I)return I;if(n){const n=await e(t);if(n&&n!==t)return await u(n,!1,i)}if(i){const e=await c(t);if(e)return await m(e)}return null}async function f(t,n=!0){var i;if(/^\d+$/.test(t))return t;const o=null==(i=/\/stories\/(\d+)/.exec(t))?void 0:i[1];if(o)return o;if(n){const n=await e(t);if(n&&n!==t)return await f(n,!1)}return null}function _(t){try{const e=atob(t).split(":").pop();return/^\d+$/.test(e)?e:null}catch(e){return null}}async function p(t){var e;const n=await i({q:`node(${t}){id}`}),r=o(n);return null==(e=Object.keys(r))?void 0:e[0]}async function m(t){var e,n;if(a.videoIdToPostId[t])return a.videoIdToPostId[t];const s=await i({fb_api_req_friendly_name:"CometTahoeRootQuery",variables:{caller:"TAHOE",chainingCursor:null,chainingSeedVideoId:null,channelEntryPoint:"TAHOE",channelID:"",feedbackSource:41,feedLocation:"TAHOE",focusCommentID:null,isCrawler:!1,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"video_channel",scale:2,streamChainingSection:!1,useDefaultActor:!1,videoChainingContext:null,videoID:t,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0,__relay_internal__pv__GHLShouldChangeSponsoredDataFieldNamerelayprovider:!1,__relay_internal__pv__GHLShouldChangeAdIdFieldNamerelayprovider:!1,__relay_internal__pv__IsWorkUserrelayprovider:!1,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1,__relay_internal__pv__StoriesLWRVariantrelayprovider:"www_new_reactions"},doc_id:"9471108166319679"}),l=o(s,[],!0);console.log("videoIdToPostId",l);const d=r(l,"post_id")||r(l,"parent_feedback.share_fbid")||(null==(n=null==(e=r(l,"legacy_token"))?void 0:e.split("_"))?void 0:n[0])||r(l,"feedback.subscription_target_id");return a.videoIdToPostId[t]=d,d}export{d as getCommentIdFromUrl,s as getIdFromUrl,u as getPostIdFromUrl,f as getStoryBucketIdFromUrl,l as getUidFromUrl,c as getVideoIdFromUrl,_ as postIdFromBase64Id,p as storyIdToPostId,m as videoIdToPostId};
