import{aR as n,X as l,az as i,y as o,x as e,V as t,W as d}from"./MyApp-DRRa55Bd.js";import{extractVideoVariants as u}from"./videos-DtjqJObU.js";import"./index-DZEcYG8Q.js";import{R as a}from"./reactions-DA-LA4iH.js";import"./___vite-browser-external_commonjs-proxy-D5wFEbJ4.js";var r=(n=>(n.PHOTO="Photo",n.VIDEO="Video",n.STICKER="Sticker",n.GIF="GenericAttachmentMedia",n))(r||{}),v=(n=>(n.AUTHOR="author",n.TOP_FAN="top_fan",n.RISING_FAN="rising_fan",n))(v||{});const s={author:{en:"Author",vi:"Tác giả"},top_fan:{en:"Top Fan",vi:"Fan cứng"},rising_fan:{en:"Rising Fan",vi:"Fan đang lên"}};var c=(n=>(n.RECENT_ACTIVITY="RECENT_ACTIVITY_INTENT_V1",n.RANKED_FILTERED="RANKED_FILTERED_INTENT_V1",n.ADMIN_HIDDEN="ADMIN_HIDDEN_INTENT_V1",n.CHRONOLOGICAL_UNFILTERED="CHRONOLOGICAL_UNFILTERED_INTENT_V1",n.STARS_INTENT_V1="STARS_INTENT_V1",n))(c||{});const _={CHRONOLOGICAL_UNFILTERED_INTENT_V1:{en:"All comments",vi:"Tất cả bình luận",icon:"fa-solid fa-comments",description:{vi:"Hiển thị tất cả bình luận, bao gồm cả nội dung có thể là spam.",en:"Show all comments, including potential spam."}},RECENT_ACTIVITY_INTENT_V1:{en:"Newest",vi:"Mới nhất",icon:"fa-solid fa-clock-rotate-left",description:{vi:"Hiển thị tất cả bình luận, theo thứ tự là các bình luận mới nhất trước tiên.",en:"Show all comments with the newest comments first."}},RANKED_FILTERED_INTENT_V1:{en:"Most relevant",vi:"Phù hợp nhất",icon:"fa-solid fa-thumbs-up",description:{vi:"Hiển thị bình luận của bạn bè và những bình luận có nhiều lượt tương tác nhất trước tiên.",en:"Show friends' comments and the most engaging comments first."}},ADMIN_HIDDEN_INTENT_V1:{en:"Hidden",vi:"Đã ẩn",icon:"fa-solid fa-eye-slash",description:{vi:"Hiển thị bình luận đã ẩn của bạn trong ngữ cảnh gốc của bài viết. Chỉ bạn mới nhìn thấy nội dung này.",en:"Show your hidden comments in their original context from the post. Only you can see this."}},STARS_INTENT_V1:{en:"Sent with Stars",vi:"Đã gửi kèm Sao",icon:"fa-solid fa-star",description:{vi:"Chỉ hiển thị bình luận kèm theo Sao.",en:"Show only comments that are sent with Stars."}}};async function m({postId:n,cursor:t="",type:d="RECENT_ACTIVITY_INTENT_V1"}){const u=btoa("feedback:"+n),a=t?await o({fb_api_req_friendly_name:"CommentsListComponentsPaginationQuery",variables:{commentsAfterCount:-1,commentsAfterCursor:t,commentsBeforeCount:null,commentsBeforeCursor:null,commentsIntentToken:d,feedLocation:"DEDICATED_COMMENTING_SURFACE",focusCommentID:null,scale:2,useDefaultActor:!1,id:u,__relay_internal__pv__IsWorkUserrelayprovider:!1},doc_id:"28843177298663113"}):await o({fb_api_req_friendly_name:"CommentListComponentsRootQuery",variables:{commentsIntentToken:d,feedLocation:"DEDICATED_COMMENTING_SURFACE",feedbackSource:110,focusCommentID:null,scale:2,useDefaultActor:!1,id:u,__relay_internal__pv__IsWorkUserrelayprovider:!1},doc_id:"24020614617526524"}),r=e(a,{},!0);console.log("json",r);const{edges:v=[],page_info:s={}}=i(r)||{},c=v.map((n=>h(n,s))),_={total:l(r,"comment_rendering_instance.comments.total_count")||0,comments:c};return console.log("result",_),_}function h(n,i){var o,e,d,u,r,v,s,c,_,m,h,p,g,b,y,I,T,N,E,C,k,A,w,D,R,S,V,F,L,M,O,x,H,G,U,P,q,j,B,K,$,W,Y,Q,z,X,J,Z,nn,ln,on,en,tn,dn,un,an,rn;const vn=(null==(u=null==(d=null==(e=null==(o=null==n?void 0:n.node)?void 0:o.feedback)?void 0:e.top_reactions)?void 0:d.edges)?void 0:u.map((n=>{var l;return{id:null==(l=null==n?void 0:n.node)?void 0:l.id,count:null==n?void 0:n.reaction_count}})))||[],sn=(null==(r=null==n?void 0:n.node)?void 0:r.preferred_body)||(null==(v=null==n?void 0:n.node)?void 0:v.body_renderer)||(null==(s=null==n?void 0:n.node)?void 0:s.body),cn=null==(m=null==(_=null==(c=null==n?void 0:n.node)?void 0:c.feedback)?void 0:_.viewer_feedback_reaction_info)?void 0:m.id;return{id:null==(h=null==n?void 0:n.node)?void 0:h.id,legacy_fbid:null==(p=null==n?void 0:n.node)?void 0:p.legacy_fbid,depth:null==(g=null==n?void 0:n.node)?void 0:g.depth,url:null==(y=null==(b=null==n?void 0:n.node)?void 0:b.feedback)?void 0:y.url,created_time:1e3*((null==(I=null==n?void 0:n.node)?void 0:I.created_time)||0),text:(null==sn?void 0:sn.text)||"",tags:null==(T=null==sn?void 0:sn.ranges)?void 0:T.map((n=>{var l,i,o,e,t;return{id:null==(l=null==n?void 0:n.entity)?void 0:l.id,type:null==(i=null==n?void 0:n.entity)?void 0:i.__typename,url:null==(o=null==n?void 0:n.entity)?void 0:o.profile_url,name:null==(e=null==n?void 0:n.entity)?void 0:e.short_name,length:null==n?void 0:n.length,offset:null==n?void 0:n.offset,text:(null==(t=null==sn?void 0:sn.text)?void 0:t.slice((null==n?void 0:n.offset)||0,((null==n?void 0:n.offset)||0)+((null==n?void 0:n.length)||0)))||""}})),author:{id:null==(E=null==(N=null==n?void 0:n.node)?void 0:N.author)?void 0:E.id,avatar:l(null==(C=null==n?void 0:n.node)?void 0:C.author,"uri"),name:null==(A=null==(k=null==n?void 0:n.node)?void 0:k.author)?void 0:A.name,gender:null==(D=null==(w=null==n?void 0:n.node)?void 0:w.author)?void 0:D.gender,url:null==(S=null==(R=null==n?void 0:n.node)?void 0:R.author)?void 0:S.url,is_verified:null==(F=null==(V=null==n?void 0:n.node)?void 0:V.author)?void 0:F.is_verified,short_name:null==(M=null==(L=null==n?void 0:n.node)?void 0:L.author)?void 0:M.short_name,subscribe_status:null==(x=null==(O=null==n?void 0:n.node)?void 0:O.author)?void 0:x.subscribe_status,work_info:null==(G=null==(H=null==n?void 0:n.node)?void 0:H.author)?void 0:G.work_info},badges:null==(q=null==(P=null==(U=null==n?void 0:n.node)?void 0:U.discoverable_identity_badges_web)?void 0:P.map((n=>{const l=null==n?void 0:n.identity_badge_type;return{type:l,title:null==n?void 0:n.information_title,description:null==n?void 0:n.information_description,icon:"https://www.facebook.com"+(null==n?void 0:n.grey_badge_asset),earned:(null==n?void 0:n.is_earned)||"author"===l}})))?void 0:q.filter((n=>n.earned)),signals:null==($=null==(K=null==(B=null==(j=null==n?void 0:n.node)?void 0:j.author_user_signals_renderer)?void 0:B.user_signals_info)?void 0:K.displayed_user_signals)?void 0:$.map((n=>{var l,i,o;return{id:null==n?void 0:n.id,type:null==n?void 0:n.signal_type_id,title:null==(l=null==n?void 0:n.title)?void 0:l.text,icon:(null==(i=null==n?void 0:n.lightModeImage)?void 0:i.uri)||(null==(o=null==n?void 0:n.darkModeImage)?void 0:o.uri)}})),reply:{count:null==(Q=null==(Y=null==(W=null==n?void 0:n.node)?void 0:W.feedback)?void 0:Y.replies_fields)?void 0:Q.count,total_count:null==(J=null==(X=null==(z=null==n?void 0:n.node)?void 0:z.feedback)?void 0:X.replies_fields)?void 0:J.total_count,expansion_token:null==(ln=null==(nn=null==(Z=null==n?void 0:n.node)?void 0:Z.feedback)?void 0:nn.expansion_info)?void 0:ln.expansion_token,comments:[]},react:{total:vn.reduce(((n,l)=>n+l.count),0)||Number((null==(tn=null==(en=null==(on=null==n?void 0:n.node)?void 0:on.feedback)?void 0:en.reactors)?void 0:tn.count_reduced)||0),each:vn,my:cn?{id:cn,name:t(null==(dn=a[cn])?void 0:dn.display_name)}:null},attachments:f((null==(un=null==n?void 0:n.node)?void 0:un.attachments)||[]),parent_id:null==(rn=null==(an=null==n?void 0:n.node)?void 0:an.comment_parent)?void 0:rn.id,cursor:null==i?void 0:i.end_cursor}}function f(n){return n.map((n=>{var i,o,e,t,d,a,r,v,s,c,_,m,h,f,p,g,b,y,I,T;const N=l(n,"attachment");switch((null==(i=null==N?void 0:N.target)?void 0:i.__typename)||(null==(o=null==N?void 0:N.media)?void 0:o.__typename)){case"Photo":const n=null==N?void 0:N.media;return{id:null==(e=null==N?void 0:N.media)?void 0:e.id,type:"Photo",url:null==N?void 0:N.url,image:null==(t=null==n?void 0:n.image)?void 0:t.uri,width:null==(d=null==n?void 0:n.image)?void 0:d.width,height:null==(a=null==n?void 0:n.image)?void 0:a.height,description:null==n?void 0:n.accessibility_caption};case"Video":const i=null==N?void 0:N.media;return(null==i?void 0:i.animated_image)?{id:null==i?void 0:i.id,type:"GenericAttachmentMedia",url:null==N?void 0:N.url,image:null==(r=null==i?void 0:i.animated_image)?void 0:r.uri}:{id:null==i?void 0:i.id,type:"Video",url:null==i?void 0:i.permalink_url,image:null==(s=null==(v=null==i?void 0:i.preferred_thumbnail)?void 0:v.image)?void 0:s.uri,duration:null==i?void 0:i.length_in_second,width:null==i?void 0:i.width,height:null==i?void 0:i.height,video:{id:null==i?void 0:i.id,length:null==i?void 0:i.length_in_second,width:null==i?void 0:i.width,height:null==i?void 0:i.height,source:null==(m=null==(_=null==(c=l(i,"progressive_urls"))?void 0:c.map((n=>{var l;return{url:null==n?void 0:n.progressive_url,quality:(null==(l=null==n?void 0:n.metadata)?void 0:l.quality)||""}})).sort(((n,l)=>n.quality.localeCompare(l.quality))))?void 0:_[0])?void 0:m.url,variants:u(l(i,"dash_manifests.manifest_xml"))}};case"Sticker":const o=null==N?void 0:N.media;return{id:null==o?void 0:o.id,type:"Sticker",url:null==(h=null==o?void 0:o.sprite_image)?void 0:h.uri,image:null==(f=null==o?void 0:o.image)?void 0:f.uri,width:null==(p=null==o?void 0:o.image)?void 0:p.width,height:null==(g=null==o?void 0:o.image)?void 0:g.height,description:(null==(b=null==o?void 0:o.pack)?void 0:b.name)||(null==o?void 0:o.label)};case"GenericAttachmentMedia":const E=null==N?void 0:N.media;return{id:null==E?void 0:E.id,type:"GenericAttachmentMedia",url:null==N?void 0:N.url,image:(null==(I=null==(y=null==E?void 0:E.media)?void 0:y.animated_image)?void 0:I.uri)||(null==(T=null==E?void 0:E.image)?void 0:T.uri)}}return null})).filter(Boolean)}async function p({commentId:n,expansionToken:l,cursor:t=null}){var d;const u=atob(n),a=null==(d=null==u?void 0:u.split(":"))?void 0:d[1],[r,v]=(null==a?void 0:a.split("_"))||[],s=btoa(`feedback:${r}_${v}`),c=await o({fb_api_req_friendly_name:"Depth1CommentsListPaginationQuery",variables:{clientKey:null,expansionToken:l,feedLocation:"DEDICATED_COMMENTING_SURFACE",focusCommentID:null,repliesAfterCount:null,repliesAfterCursor:t||null,repliesBeforeCount:null,repliesBeforeCursor:null,scale:2,useDefaultActor:!1,id:s,__relay_internal__pv__IsWorkUserrelayprovider:!1},doc_id:"9847933891911243"}),_=e(c,{},!0);console.log("depth 1",_);const{edges:m=[],page_info:f={}}=i(_)||{};return m.map((n=>h(n,f)))}async function g({commentId:n,reactionId:i}){var t,u,a,r,v,s,c,_;let m=null;try{const l=atob(n),i=null==(t=null==l?void 0:l.split(":"))?void 0:t[1],[o,e]=(null==i?void 0:i.split("_"))||[];m=btoa(`feedback:${o}_${e}`)}catch(g){return console.error("reactToComment > error",g),null}const h=await o({fb_api_req_friendly_name:"CometUFIFeedbackReactMutation",variables:{input:{feedback_id:m,feedback_reaction_id:i,feedback_source:"PROFILE",is_tracking_encrypted:!0,actor_id:await d()},useDefaultActor:!1,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1},doc_id:"24034997962776771"}),f=e(h,{},!0);console.log("react to comment",f);const p=l(f,"feedback_react.feedback");return{feedbackId:(null==p?void 0:p.id)||m,total:(null==(u=null==p?void 0:p.reaction_count)?void 0:u.count)||(null==(a=null==p?void 0:p.unified_count)?void 0:a.count)||0,each:null==(v=null==(r=null==p?void 0:p.top_reactions)?void 0:r.edges)?void 0:v.map((n=>{var l,i;return{id:null==(l=null==n?void 0:n.node)?void 0:l.id,count:null==n?void 0:n.reaction_count,name:null==(i=null==n?void 0:n.node)?void 0:i.localized_name}})),url:null==p?void 0:p.url,your:{uid:null==(s=null==p?void 0:p.viewer_actor)?void 0:s.id,name:null==(c=null==p?void 0:p.viewer_actor)?void 0:c.name,reactionId:null==(_=null==p?void 0:p.viewer_feedback_reaction_info)?void 0:_.id}}}async function b(o){var e;const t=await n(`/${o}`),d=l(t,"comment_rendering_instance_for_feed_location.comments");if(console.log("comments",d),!(null==(e=null==d?void 0:d.edges)?void 0:e.length))return null;const{edges:u=[],page_info:a={}}=i(d)||{},r=u.map((n=>h(n,a))),v=null==r?void 0:r.find((n=>n.id===o||n.legacy_fbid===o));return console.log("comment",r,v),v}export{r as CommentAttachmentType,c as CommentIntentToken,_ as CommentIntentTokenNames,v as IdentityBadgeType,s as IdentityBadgeTypeNames,f as extractCommentAttachments,h as extractCommentData,b as getCommentInfoFromId,m as getPostComments,p as getReplyComments,g as reactToComment};
