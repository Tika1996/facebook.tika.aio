const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./VideoViewer-C2qoCs6p.js","./index-DZEcYG8Q.js","./index-C6k8ZUm0.css","./videos-DtjqJObU.js","./___vite-browser-external_commonjs-proxy-D5wFEbJ4.js","./MyApp-DRRa55Bd.js","./Media-BZfv9k1B.js","./posts-DYhkBr35.js","./useCacheState-D4ghBCVU.js","./reactions-DA-LA4iH.js","./download-KJKGHAGZ.js","./Table-DDck-vB7.js","./addEventListener-C9VBchln.js","./List-BPJoeCz4.js","./DownOutlined-BrkIPj-I.js","./index-BRk8JeT5.js","./index-CEGXIRel.js","./index-BQAhaSn9.js","./index-KPoWFIyW.js","./dropdown-BoVCRztz.js","./Dropdown-BgvXKd3u.js","./PurePanel-Beni9Vkb.js","./move-Bzyc79vL.js","./index-D9U4WvIE.js","./index-CvALG2oX.js","./SearchOutlined-Bh66KhXc.js","./useBreakpoint-HjQEkdEA.js","./Pagination-Dv2YSLQ3.js","./Input-LTpJ6AuY.js","./index-DhxhS065.js","./index-C0Edlh-n.js","./index-B87p3I4c.js","./EyeOutlined-BBPXKIU8.js","./row-BgRGnxnv.js","./index-BE0FsmaM.js","./index-CG5dclLJ.js","./col-DLTiGXF3.js","./index-DHhmxYJT.js","./index-DOt91uSA.js","./index-BjI9_D7Z.js"])))=>i.map(i=>d[i]);
import{bc as e,r as t,b1 as n,b2 as i,b5 as o,bk as s,aY as a,bi as l,bj as r}from"./index-DZEcYG8Q.js";import{PrivacyScope as d,PrivacyScopeName as c,getGroupPosts as h,getPosts as u,deletePost as v,convetPostIdToStoryId as m,trashPost as g,setPostPrivacy as p,unTagPost as x,findFirstPost as y,searchAllPostsOnFB as f}from"./posts-DYhkBr35.js";import{d as j}from"./dayjs.min-BxbhFvXw.js";import{u as b,d as k,a as w,z as P,t as T,v as C,aH as _,S as D,i as S,h as F,b as I,s as N,B as E,c as B,l as L,e as R,f as M,g as O,T as U,A,j as W,I as V,W as q}from"./MyApp-DRRa55Bd.js";import z from"./useCacheState-D4ghBCVU.js";import K from"./MyTable-D1FbPMwN.js";import X from"./ExportButton-CPuYvz9B.js";import{postIdFromBase64Id as H,getPostIdFromUrl as G,getUidFromUrl as $}from"./getIds-BE6G2xp0.js";import{checkVIP as Y}from"./useVIP-CGpIDALh.js";import{u as Q}from"./useAction-DQs_XsxB.js";import{B as J}from"./BadgeWrapper-D8uZ2wKG.js";import{u as Z}from"./useDevMode-DFNrRWnS.js";import{S as ee}from"./Screen-1_H4V3tg.js";import{R as te,g as ne}from"./reactions-DA-LA4iH.js";import{getMyManagedGroups as ie}from"./groups-B049n8MW.js";import{A as oe}from"./index-DhxhS065.js";import{I as se}from"./index-BE0FsmaM.js";import{C as ae}from"./index-B2BHea4N.js";import{S as le}from"./index-D9U4WvIE.js";import{P as re}from"./index-C0Edlh-n.js";import{I as de}from"./index-B87p3I4c.js";import{D as ce}from"./index-B0BghIXV.js";import{S as he}from"./index-l5dW_dFo.js";import{T as ue}from"./index-DOt91uSA.js";import{R as ve}from"./row-BgRGnxnv.js";import{M as me}from"./index-iP3EwXx5.js";import"./videos-DtjqJObU.js";import"./___vite-browser-external_commonjs-proxy-D5wFEbJ4.js";import"./index-BA5m7QhG.js";import"./Table-DDck-vB7.js";import"./addEventListener-C9VBchln.js";import"./List-BPJoeCz4.js";import"./DownOutlined-BrkIPj-I.js";import"./index-BRk8JeT5.js";import"./index-CEGXIRel.js";import"./index-BQAhaSn9.js";import"./index-KPoWFIyW.js";import"./dropdown-BoVCRztz.js";import"./Dropdown-BgvXKd3u.js";import"./PurePanel-Beni9Vkb.js";import"./move-Bzyc79vL.js";import"./useBreakpoint-HjQEkdEA.js";import"./Pagination-Dv2YSLQ3.js";import"./index-CvALG2oX.js";import"./SearchOutlined-Bh66KhXc.js";import"./Input-LTpJ6AuY.js";import"./EyeOutlined-BBPXKIU8.js";import"./sweetalert2.esm.all-BZxvatOx.js";import"./index-CiDxWY8X.js";import"./index-DHhmxYJT.js";import"./col-DLTiGXF3.js";const ge=i((()=>a((()=>import("./VideoViewer-C2qoCs6p.js")),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),{fallback:V}),pe=i((()=>a((()=>import("./Media-BZfv9k1B.js").then((e=>e.M))),__vite__mapDeps([6,1,2,5,7,3,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]),import.meta.url)),{fallback:V}),xe=[d.EVERYONE,d.FRIENDS,d.FRIENDS_OF_FRIENDS,d.SELF],ye=new Set([d.EVERYONE,d.CUSTOM,d.FRIENDS_OF_FRIENDS]),fe=Object.keys(d).filter((e=>!ye.has(e))),je=e=>{var t,n,i,o;return L(e.title||e.summary||e.message||(null==(t=e.content)?void 0:t.text)||(null==(o=null==(i=null==(n=e.content)?void 0:n.attachments)?void 0:i.find((e=>e.title)))?void 0:o.title),30)||M(e.creation_time)},be={uid:"",privacy:d.ALL,omitPinnedPost:!1,beforeTime:null,taggedInOnly:!1,postedByOthers:null};function ke({target:i}){var V,ye;const{ti:ke}=b(),we=e(),{message:Pe,notification:Te}=k(),{devMode:Ce}=Z(),{onClickAction:_e,onClickBulkActions:De}=Q(),[Se,Fe]=z("Posts.showFilters",!1),[Ie,Ne]=z("Posts.showSettings",!1),[Ee,Be]=z("Posts.useDeleteApiV2",!1),[Le,Re]=z("Posts.myManagedGroups",[]),{profile:Me}=w(),Oe=(null==i?void 0:i.id)||"",[Ue,Ae]=z("Posts.postFilters",be),[We,Ve]=z("Posts.autoLoadReactions",!1),[qe,ze]=z("Posts.maxPosts."+Oe,9),[Ke,Xe]=z("Posts.uid."+Oe,Oe),[He,Ge]=z("Posts.profile."+Oe,i),[$e,Ye]=z("Posts.posts."+Oe,[]),[Qe,Je]=z("Posts.reactions."+Oe,{}),[Ze,et]=z("Posts.loading."+Oe,!1),[tt,nt]=z("Posts.loadingFirstPost."+Oe,!1),[it,ot]=z("Posts.loadingReactions."+Oe,!1),[st,at]=t.useState(null),[lt,rt]=z("Posts.isFindingHiddenPosts."+Oe,!1),[dt,ct]=z("Posts.hiddenPostsKeywords."+Oe,"a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z"),ht=(null==He?void 0:He.type)===P.Group,ut=t.useMemo((()=>ht&&Le.some((e=>e.id===(null==He?void 0:He.id)))),[ht,Le,He]),vt=t.useMemo((()=>$e.filter(Boolean).map(((e,t)=>{var n,i,o,s;return{...e,recent:t,reactions:{total:(null==(i=null==(n=Qe[e.id])?void 0:n.reduce)?void 0:i.call(n,((e,t)=>e+t.count),0))||(null==(o=e.reactions)?void 0:o.total)||0,top:Qe[e.id]||(null==(s=e.reactions)?void 0:s.top)||[]}}}))),[$e,Qe]);t.useEffect((()=>{T("Posts:onLoad")}),[]),t.useEffect((()=>{i&&i.id!==Ke&&(Xe(i.id),setTimeout((()=>{gt(i.id)}),1e3))}),[i,Ke]);const mt=async(e="",t="")=>{const n=e||Ke||Ue.uid;return ht?await h({groupId:n,cursor:t}):await u({...Ue,uid:n,cursor:t})},gt=async(e,t=!1)=>{var i,o;const s=t?"Posts:onClickLoadMore":"Posts:onClickReload";T(s),et(!0),rt(!1),!t&&ht&&ie().then(Re),Pe.loading({key:s,content:ke({en:"Fetching posts...",vi:"Đang tải bài viết..."}),duration:0});const a=t?[...$e]:[],l=new Set(a.map((e=>e.id)));let r=(null==(i=a[a.length-1])?void 0:i.cursor)||"",d=!1,c=0;for(;c<qe&&!d;){const t=await mt(e,r);if(!(null==t?void 0:t.length))break;for(let e of t)l.has(e.id)||(l.add(e.id),a.push(e),c++);console.log(a),Pe.loading({key:s,content:n.jsxs(n.Fragment,{children:[ke({en:"Fetching posts...",vi:"Đang tải bài viết..."})+c+"/"+qe,n.jsx("br",{}),ke({en:"Click to stop",vi:"Bấm để dừng"})]}),onClick:()=>d=!0,duration:0}),Ye([...a]),r=null==(o=a[a.length-1])?void 0:o.cursor,We&&await yt(t,!1,!1),await C(1e3)}0===a.length?Pe.info({key:s,content:ke({en:"Posts not found",vi:"Không tìm thấy bài viết nào"})}):Pe.success({key:s,content:t?ke({en:"Load more posts success: ",vi:"Tải thêm thành công: "})+c:ke({en:"Fetch posts success: ",vi:"Tải bài viết thành công: "})+a.length}),et(!1)},pt=async()=>{if(!(await Y()))return;const e="Posts:onClickFindFirstPost";T(e),nt(!0),Pe.loading({key:e,content:ke({en:"Finding first post...",vi:"Tìm bài viết đầu tiên..."}),duration:0});let t=r,n=Date.now();Ye([]);const i=await y({uid:Ke||Ue.uid||"",startTime:t,endTime:n,progress:(t,n)=>{console.log(t,n),Pe.loading({key:e,content:ke({en:"Finding first post...",vi:"Tìm bài viết đầu tiên..."})+M(t),duration:0}),(null==n?void 0:n.length)&&Ye((e=>{const t=new Set(e.map((e=>e.id)));return[...n.filter((e=>!t.has(e.id))),...e].sort(((e,t)=>t.creation_time-e.creation_time))}))}});i?(Pe.destroy(e),Te.open({key:e,type:"success",message:ke({en:"Find first post done: ",vi:"Tìm bài viết đầu tiên xong: "})+M(i.creation_time),description:i.url})):Pe.info({key:e,content:ke({en:"First post not found",vi:"Không tìm thấy bài viết đầu tiên"})}),nt(!1),console.log(i)},xt=async(e,t=!1)=>{const n=je(e);return _e({key:"Posts:onLoadReactions",id:e.id,record:e,actionFn:async()=>{try{const t=e.post_id||H(e.id)||await G(e.url),n=await ne(t);return Je((t=>({...t,[e.id]:n}))),!0}catch(t){return console.error(t),!1}},loadingText:()=>ke({en:"Loading reactions..",vi:"Đang tải lượt thích.."})+n,successText:()=>ke({en:"Reactions loaded: ",vi:"Tải lượt thích thành công: "})+n,failedText:()=>ke({en:"Reactions load failed: ",vi:"Không tải được lượt thích: "})+n,onSuccess:()=>{},needConfirm:t,confirmProps:{title:ke({en:"Load reactions?",vi:"Tải lượt thích?"}),text:n}})},yt=async(e,t=!0,n=!0)=>(ot(!0),De({data:e,key:"Posts:onLoadReactionsBulk",actionFn:xt,loadingText:e=>ke({en:"Loading reactions...",vi:"Đang tải lượt thích..."}),successText:e=>ke({en:"Loaded reactions",vi:"Hoàn tất tải lượt thích"}),successDescItem:e=>je(e),needConfirm:t,showSuccessNoti:n,confirmProps:{title:ke({en:"Load reactions of "+e.length+" posts?",vi:"Tải lượt thích của "+e.length+" bài viết?"}),text:ke({en:"Warning: This action will call api for each post. Please only select posts you want to load reactions. To reduce the chance of being banned by fb, please spread the posts to load reactions.",vi:"Lưu ý: Sẽ gọi api cho từng bài viết. Vui lòng chỉ chọn bài muốn tải lượt thích. Để giảm tỷ lệ bị fb ban"})}}).finally((()=>{ot(!1)}))),ft=async(e,t=!1)=>{const n=je(e);return _e({key:"Posts:onDeletePost",id:e.id,record:e,actionFn:()=>Ce?C(1e3):v(Ee?m(e.actor.id,e.post_id):e.story_id),loadingText:()=>ke({en:"Deleting post..",vi:"Đang xoá bài viết.."})+n,successText:()=>ke({en:"Post deleted: ",vi:"Xoá bài viết thành công: "})+n,failedText:()=>ke({en:"Post not deleted: ",vi:"Không xoá được bài viết: "})+n,onSuccess:()=>{Ye((t=>l(t,(t=>{const n=t.find((t=>t.story_id===e.story_id));n&&(n.deleted=!0)}))))},needConfirm:t,confirmProps:{title:ke({en:"Delete post?",vi:"Xoá bài viết?"}),text:n}})},jt=async(e,t=!1)=>{const n=je(e);return _e({key:"Posts:onTrashPost",id:e.id,record:e,actionFn:()=>Ce?C(1e3):g(e.story_id),loadingText:()=>ke({en:"Moving post to trash..",vi:"Đang chuyển bài viết vào thùng rác.."})+n,successText:()=>ke({en:"Post trashed: ",vi:"Chuyển bài viết vào thùng rác thành công: "})+n,failedText:()=>ke({en:"Post not trashed: ",vi:"Không chuyển được bài viết vào thùng rác: "})+n,onSuccess:()=>{Ye((t=>l(t,(t=>{const n=t.find((t=>t.story_id===e.story_id));n&&(n.trashed=!0)}))))},needConfirm:t,confirmProps:{title:ke({en:"Move post to trash? (Delete after 30 days)",vi:"Chuyển vào thùng rác? (Bị xoá sau 30 ngày)"}),text:n}})},bt=async(e,t,n=!1)=>{const i=je(e),o=ke(c[t]);return _e({key:"Posts:onChangePostPrivacy",id:e.id,record:e,actionFn:()=>Ce?C(1e3):p({writeID:e.privacy.write_id,baseState:t}),loadingText:()=>ke({en:"Changing post privacy to "+o+"..",vi:"Đang sửa quyền riêng tư sang "+o+".."})+i,successText:()=>ke({en:"Change post privacy success "+o+": ",vi:"Sửa quyền riêng tư thành công "+o+": "})+i,failedText:()=>ke({en:"Change post privacy failed "+o+": ",vi:"Sửa quyền riêng tư lỗi "+o+": "})+i,onSuccess:()=>{Ye((n=>l(n,(n=>{const i=n.find((t=>t.story_id===e.story_id));i&&(i.privacy.scope=t)}))))},needConfirm:n,confirmProps:{title:ke({en:"Change post privacy? ",vi:"Sửa quyền riêng tư? "}),text:o+"; "+i}})},kt=async(e,t=!1)=>{const n=je(e);return _e({key:"Posts:onUnTagPost",id:e.id,record:e,actionFn:()=>Ce?C(1e3):x(e.story_id),loadingText:()=>ke({en:"Untagging post..",vi:"Đang gỡ thẻ bài viết.."})+n,successText:()=>ke({en:"Post untagged: ",vi:"Gỡ thẻ bài viết thành công: "})+n,failedText:()=>ke({en:"Post not untagged: ",vi:"Không gỡ được thẻ bài viết: "})+n,onSuccess:()=>{Ye((t=>l(t,(t=>{const n=t.find((t=>t.story_id===e.story_id));n&&(n.untagged=!0)}))))},needConfirm:t,confirmProps:{title:ke({en:"Untag post?",vi:"Gỡ thẻ bài viết?"}),text:n}})},wt=async()=>{var e;const t="Posts:FindAllPosts";T(t);const i=Ke||Ue.uid||await q()||"",o=(await a((async()=>{const{default:e}=await import("./sweetalert2.esm.all-BZxvatOx.js");return{default:e}}),[],import.meta.url)).default,s=await o.fire({title:ke({en:"Find hidden posts",vi:"Tìm kiếm bài viết ẩn"}),html:ke({en:"Auto loop through all <br>keywords</b> to search all posts (owned/tagged) of this profile on Facebook.\n                <br/><br/>Support search in <b>locked profile</b>.",vi:"Tự động lặp qua <b>danh sách từ khoá</b> để tìm kiếm tất cả bài viết (trên hội nhóm/được tag) của người dùng này trên Facebook.\n                <br/><br/>Chấp <b>khoá trang cá nhân</b> cũng tìm được."}),confirmButtonText:ke({en:"Auto search",vi:"Tìm tự động"}),showCancelButton:!0,cancelButtonText:ke({en:"Read more",vi:"Đọc thêm"}),showDenyButton:!0,denyButtonText:ke({en:"Manual search",vi:"Tìm thủ công"}),reverseButtons:!0});if(s.isDenied)return void we("/search-fb-posts",{state:{targetUid:i}});if(s.isDismissed)return void(s.dismiss==o.DismissReason.cancel&&window.open("https://www.facebook.com/groups/fbaio/posts/1708646306456717","_blank"));if(!(await Y()))return;const l=await o.fire({title:ke({en:"Keywords to search",vi:"Từ khóa tìm kiếm"}),html:ke({en:'Enter list keyword for auto search. Separate by comma.\n                    <p style="text-align: left">\n                        E.g\n                        <br/><b>Keywords:</b> love,extension,fb aio\n                        <br/><b>Alphabet:</b> a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z\n                    </p>',vi:'Nhập danh sách từ khóa để tìm kiếm tự động. Cách nhau bằng dấu phẩy.\n                    <p style="text-align: left">\n                        Ví dụ\n                        <br/><b>Từ khóa:</b> love,tiện ích,fb aio\n                        <br/><b>Bảng chữ cái:</b> a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z\n                    </p>'}),input:"text",inputPlaceholder:ke({en:"Enter keywords (separate by comma)",vi:"Nhập từ khóa (cách nhau bằng dấu phẩy)"}),inputAttributes:{list:"keywords"},inputValue:dt});if(l.isDismissed)return;const r=l.value;ct(r),rt(!0);const d=Array.from(new Set(r.split(","))),c=[],h=new Set,u=new Map;let v=!1;for(let a of d){if(v)break;let i=!0,o=null;for(;i&&!v;){Pe.loading({content:n.jsxs(n.Fragment,{children:[ke({en:"Searching posts... with text: ",vi:"Đang tìm kiếm bài viết.. với từ khóa: "}),n.jsx("b",{children:a}),n.jsx("br",{}),n.jsxs("span",{children:[ke({en:"Found",vi:"Tìm thấy"})," ",c.length," ",ke({en:"posts",vi:"bài viết"})]}),n.jsx("br",{}),ke({en:"Click to stop",vi:"Nhấn để dừng"})]}),key:t,duration:0,onClick:()=>{Pe.loading({content:ke({en:"Stopping...",vi:"Đang dừng..."}),key:t,duration:0}),v=!0}});const s=await f({uid:Ke,text:a,cursor:o});i=!1;let l=0;for(let e of s)h.has(e.id)||(h.add(e.id),c.push(e),l++,i=!0);i&&(u.set(a,(u.get(a)||0)+l),Ye([...c]),o=(null==(e=s[s.length-1])?void 0:e.cursor)||null,await C(1e3))}await C(1e3)}Pe.destroy(t+"-stop"),Pe.destroy(t),Te.success({message:ke({en:"Found "+c.length+" posts. Searched: ",vi:"Tìm thấy "+c.length+" bài viết. Từ khoá: "})+Array.from(u).map((([e,t])=>e+" ("+t+")")).join(", "),duration:0})},Pt=t.useMemo((()=>vt.some((e=>{var t;return(null==(t=e.reactions)?void 0:t.total)>0}))),[vt]),Tt=t.useMemo((()=>vt.some((e=>{var t;return(null==(t=e.comments)?void 0:t.total)>0}))),[vt]),Ct=t.useMemo((()=>vt.some((e=>{var t;return(null==(t=e.shares)?void 0:t.total)>0}))),[vt]),_t=[{title:"#",key:"recent",dataIndex:"recent",sorter:(e,t)=>e.recent-t.recent,render:(e,t,n)=>t.recent+1,width:70,align:"center"},{title:ke({en:"Actor",vi:"Người đăng"}),key:"actor",dataIndex:"actor",onSearch:(e,t,n)=>{var i,o;return N(e,(null==(i=null==n?void 0:n.actor)?void 0:i.name)+(null==(o=null==n?void 0:n.actor)?void 0:o.id))},render:(e,t,i)=>{var o,s,a,l,r,d,c,h;return n.jsxs(D,{style:{maxWidth:300},children:[n.jsx(oe,{shape:"square",src:n.jsx(se,{src:S(null==(o=t.actor)?void 0:o.id),fallback:null==(s=t.actor)?void 0:s.avatar}),size:50}),n.jsxs(D,{direction:"vertical",size:0,children:[n.jsx("a",{href:(null==(a=t.actor)?void 0:a.url)||F(null==(l=t.actor)?void 0:l.id),target:"_blank",children:n.jsx("b",{children:null==(r=t.actor)?void 0:r.name})}),n.jsx("span",{style:{opacity:.5},children:null==(d=t.actor)?void 0:d.id}),null==(h=null==(c=t.actor)?void 0:c.signals)?void 0:h.map((e=>n.jsx(I,{children:e.text},e.id)))]})]})},filters:_(vt.map((e=>e.actor)),"name"),onFilter:(e,t)=>{var n;return(null==(n=t.actor)?void 0:n.name)==e},width:250},{title:ke({en:"Media",vi:"Ảnh/Video"}),key:"media",dataIndex:"media",render:(e,t,i)=>{var o,s;const a=null==(o=t.content)?void 0:o.attachments;if((null==a?void 0:a.length)>0){const e=(null==(s=null==a?void 0:a[0])?void 0:s.total_count)||(null==a?void 0:a.length),i=1===e,o=1===e&&"Video"===a[0].type;return n.jsx(E.Ribbon,{text:o?n.jsx("i",{className:"fa-solid fa-video"}):e>1?e:null,style:{display:o||e>1?"block":"none"},children:n.jsx(se,{src:a[0].thumbnail,style:{objectFit:"cover",height:150,width:210,borderRadius:10},preview:!(!i||o)||{destroyOnHidden:!0,imageRender:()=>o?n.jsx(ge,{info:{id:a[0].id}}):n.jsx(ae,{style:{maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",borderRadius:10},children:n.jsx(pe,{target:t.actor,postId:t.id})}),toolbarRender:()=>null}})})}return"-"},filters:[{text:ke({en:"Video",vi:"Video"}),value:"video"},{text:ke({en:"Has media",vi:"Có ảnh hoặc video"}),value:"has-media"},{text:ke({en:"Multi media",vi:"Nhiều ảnh/video"}),value:"multi-media"}],onFilter:(e,t)=>{var n,i,o,s,a,l,r,d,c;return"video"===e?1===(null==(i=null==(n=t.content)?void 0:n.attachments)?void 0:i.length)&&"Video"===(null==(a=null==(s=null==(o=t.content)?void 0:o.attachments)?void 0:s[0])?void 0:a.type):"has-media"===e?(null==(r=null==(l=t.content)?void 0:l.attachments)?void 0:r.length)>0:"multi-media"===e?(null==(c=null==(d=t.content)?void 0:d.attachments)?void 0:c.length)>1:void 0},width:200,align:"right"},{title:ke({en:"Content",vi:"Nội dung"}),key:"content",dataIndex:"content",onSearch:(e,t,n)=>{var i;return[null==(i=n.content)?void 0:i.text,n.message,n.title,n.summary].filter(Boolean).some((t=>N(e,t)))},render:(e,t,i)=>{var o,s,a,l,r,d;const c=(null==(o=t.content)?void 0:o.text)||(null==(l=null==(a=null==(s=t.content)?void 0:s.attachments)?void 0:a.find((e=>e.title)))?void 0:l.title);return n.jsxs(D,{direction:"vertical",style:{maxWidth:350},children:[t.is_pinned&&n.jsx(E,{count:ke({en:"Pinned post",vi:"Bài viết Đã ghim"}),color:"green"}),(null==(r=t.summary)?void 0:r.length)>0&&n.jsx(B.Text,{style:{fontStyle:"italic"},type:"secondary",children:L(t.summary,150)}),(null==(d=t.message)?void 0:d.length)>0&&n.jsx(B.Text,{children:L(t.message,150)}),n.jsx(B.Text,{type:"secondary",children:L(c,150)})]})},width:"auto"},{title:ke({en:"Posted time",vi:"Đăng lúc"}),key:"date",dataIndex:"date",sorter:(e,t)=>e.creation_time-t.creation_time,render:(e,t,i)=>n.jsxs(D,{direction:"vertical",size:0,children:[n.jsxs(B.Text,{children:[R(t.creation_time)," ",ke({en:" ago",vi:"trước"})]}),n.jsx(B.Text,{type:"secondary",children:M(t.creation_time)})]})},{title:ke({en:"Privacy",vi:"Quyền riêng tư"}),key:"privacy",dataIndex:"privacy",render:(e,t,i)=>{var o;if(t.deleted)return n.jsx(I,{color:"red",children:ke({en:"Deleted",vi:"Đã xoá"})});const{scope:s,description:a,allow:l,deny:r}=t.privacy||{};return n.jsxs(D,{direction:"vertical",size:0,children:[(null==(o=t.privacy)?void 0:o.can_edit)?n.jsx(le,{value:s,options:xe.map((e=>({value:e,label:ke(c[e])}))),onSelect:e=>{console.log(e),bt(t,e,!0)},popupMatchSelectWidth:!1}):n.jsx(B.Text,{children:ke(c[s])}),a&&((null==l?void 0:l.length)>0||(null==r?void 0:r.length)>0)&&n.jsx(B.Text,{type:"secondary",children:a})]})},filters:Object.keys(d).map((e=>({text:ke(c[e])+" ("+vt.filter((t=>t.privacy.scope===e)).length+")",value:e}))),onFilter:(e,t)=>t.privacy.scope===e,width:150},...Pt?[{title:ke({en:"React",vi:"Thích"}),key:"reactions",dataIndex:"reactions",render:(e,t,i)=>{var o;const s=t.reactions;if(!s)return"-";const a=s.total;return n.jsxs(D,{size:3,direction:"vertical",children:[n.jsx(I,{color:a>0?"success":"default",children:O(a)}),null==(o=s.top)?void 0:o.map((e=>n.jsxs(D,{size:2,children:[n.jsx(se,{preview:!1,src:te[e.reactionId].icon,width:20,height:20})," ",O(e.count)]},e.reactionId)))]})},rangeFilter:{getValue(e){var t;return null==(t=e.reactions)?void 0:t.total}},sorter:(e,t)=>{var n,i;return(null==(n=e.reactions)?void 0:n.total)-(null==(i=t.reactions)?void 0:i.total)},width:100}]:[],...Tt?[{title:ke({en:"Comments",vi:"Bình luận"}),key:"comments",dataIndex:"comments",render:(e,t,i)=>{var o,s;return n.jsx(I,{color:(null==(o=t.comments)?void 0:o.total)>0?"success":"default",children:O(null==(s=t.comments)?void 0:s.total)})},rangeFilter:{getValue(e){var t;return null==(t=e.comments)?void 0:t.total}},sorter:(e,t)=>{var n,i;return(null==(n=e.comments)?void 0:n.total)-(null==(i=t.comments)?void 0:i.total)},width:120}]:[],...Ct?[{title:ke({en:"Shares",vi:"Chia sẻ"}),key:"shares",dataIndex:"shares",render:(e,t,i)=>{var o,s;return n.jsx(I,{color:(null==(o=t.shares)?void 0:o.total)>0?"success":"default",children:O(null==(s=t.shares)?void 0:s.total)})},rangeFilter:{getValue(e){var t;return null==(t=e.shares)?void 0:t.total}},sorter:(e,t)=>{var n,i;return(null==(n=e.shares)?void 0:n.total)-(null==(i=t.shares)?void 0:i.total)},width:120}]:[],{title:ke({en:"Action",vi:"Hành động"}),key:"action",dataIndex:"action",render:(e,t,i)=>{var a;return n.jsxs(D,{size:3,wrap:!0,style:{maxWidth:200},children:[!t.deleted&&n.jsx(U,{title:ke({en:"View detail",vi:"Xem chi tiết"}),children:n.jsx(o,{type:"primary",onClick:()=>{at(t)},icon:n.jsx("i",{className:"fa-solid fa-info"})})}),n.jsx(U,{title:ke({en:"Load reactions",vi:"Tải lượt thích"}),children:n.jsx(o,{icon:n.jsx("i",{className:"fa-solid fa-thumbs-up"}),onClick:()=>xt(t,!0)})}),(ut||t.can_delete)&&!t.deleted&&n.jsxs(n.Fragment,{children:[n.jsx(U,{title:ke({en:"Delete permanently",vi:"Xoá vĩnh viễn"}),children:n.jsx(o,{danger:!0,icon:n.jsx("i",{className:"fa-solid fa-trash"}),onClick:()=>ft(t,!0)})}),!t.trashed&&!ht&&n.jsx(U,{title:ke({en:"Move to trash",vi:"Chuyển vào thùng rác"}),children:n.jsx(o,{icon:n.jsx("i",{className:"fa-solid fa-eye-slash"}),onClick:()=>jt(t,!0)})})]}),!t.can_delete&&(null==Me?void 0:Me.id)==Ke&&Ke!==(null==(a=t.actor)?void 0:a.id)&&n.jsx(U,{title:t.untagged?ke({en:"Tag removed",vi:"Đã gỡ thẻ"}):ke({en:"Remove tag",vi:"Gỡ thẻ"}),children:n.jsx(o,{danger:!t.untagged,disabled:t.untagged,icon:n.jsx("i",{className:"fa-solid fa-user-tag"}),onClick:()=>kt(t,!0)})}),!t.deleted&&n.jsx(U,{title:ke({en:"Open in Bulk downloader",vi:"Mở trong Tải hàng loạt"}),children:n.jsx(o,{onClick:()=>{we("/bulk-downloader",{state:{targetId:t.url,platform:s.FacebookPost}})},icon:n.jsx("i",{className:"fa-solid fa-download"})})}),!t.deleted&&n.jsx(U,{title:ke({en:"View on Facebook",vi:"Xem bài viết"}),children:n.jsx(o,{href:t.trashed?"https://www.facebook.com/me/allactivity/?category_key=TRASH":t.url,target:"_blank",icon:n.jsx("i",{className:"fa-solid fa-up-right-from-square"})})})]})},width:150}],Dt=n.jsx(U,{mouseEnterDelay:.5,title:ke({en:"Load older posts. Use filters above",vi:"Tải thêm bài viết cũ hơn. Sử dụng các bộ lọc trên"}),children:n.jsx(o,{loading:Ze,icon:n.jsx("i",{className:"fa-solid fa-play"}),onClick:async()=>{if(lt){(await a((async()=>{const{default:e}=await import("./sweetalert2.esm.all-BZxvatOx.js");return{default:e}}),[],import.meta.url)).default.fire({title:ke({en:"Not supported in find hidden posts mode",vi:"Không hỗ trợ trong chế độ tìm bài viết ẩn"}),text:ke({en:'Click "Load posts" to back to normal mode',vi:'Nhấn "Tải bài viết" để về chế độ thường'})})}else gt(null,!0)},children:ke(Ze?{en:"Loading..",vi:"Đang tải.."}:{en:"Load more",vi:"Tải thêm"})})}),St=t.useMemo((()=>Object.entries(Ue).filter((([e,t])=>t!==be[e]))),[Ue]);return n.jsxs(ee,{title:ke({en:"Posts manager",vi:"Quản lý bài viết"}),titleSuffix:n.jsx(I,{color:"error",style:{marginLeft:10},children:ke({en:"🚧 Work in progress",vi:"🚧 Đang phát triển"})}),children:[n.jsxs(D,{direction:"vertical",size:0,children:[n.jsxs(D.Compact,{style:{maxWidth:"90vw",marginBottom:10,overflow:"auto"},children:[n.jsx(re,{title:(null==(ye=null==(V=null==He?void 0:He.type)?void 0:V.toUpperCase)?void 0:ye.call(V))||"User/Page/Group",content:He?n.jsxs(D,{children:[n.jsx(oe,{shape:"square",src:n.jsx(se,{src:He.avatar}),size:50}),n.jsx("a",{href:He.url,target:"_blank",children:n.jsx("b",{children:He.name})})]}):null,children:n.jsx(de,{placeholder:ke({en:"UID/URL",vi:"UID/URL"}),value:Ke,onChange:async e=>{const t=e.target.value;if(Xe(t),""==t.trim())return;T("Posts:onChangeUid:"+t);const n="Posts:onChangeUid";Pe.loading({key:n,content:ke({en:"Finding UID..",vi:"Đang tìm UID.."}),duration:0});const i=/^\d+$/.test(t)?t:await $(t);Pe.loading({key:n,content:ke({en:"Finding Profile..",vi:"Đang tìm Profile.."}),duration:0});const o=await W(i);Xe(i),Ge(o),i?Pe.success({key:n,content:ke({en:"UID found: ",vi:"Tìm thấy UID: "})+i+" - "+(null==o?void 0:o.name)}):Pe.error({key:n,content:ke({en:"UID not found",vi:"Không tìm thấy UID"})})},style:{minWidth:100,maxWidth:150},prefix:n.jsx("i",{className:"fa-solid fa-user"})})}),n.jsx(o,{onClick:()=>Fe((e=>!e)),icon:n.jsx("i",{className:"fa-solid fa-filter"}),children:n.jsxs(D,{size:3,align:"center",children:[ke({en:"Filters",vi:"Bộ lọc"})," ",n.jsx(I,{color:St.length>0?"blue":"default",style:{margin:0},children:St.length}),n.jsx("i",{style:{opacity:.5},className:"fa-solid "+(Se?"fa-chevron-up":"fa-chevron-down")})]})}),n.jsx(o,{icon:n.jsx("i",{className:"fa-solid fa-gear"}),onClick:()=>Ne(!Ie),children:n.jsxs(D,{size:3,align:"center",children:[ke({en:"Settings",vi:"Cài đặt"}),n.jsx("i",{style:{opacity:.5},className:"fa-solid "+(Ie?"fa-chevron-up":"fa-chevron-down")})]})}),n.jsx(o,{type:lt?"default":"primary",onClick:()=>gt(),icon:n.jsx("i",{className:"fa-solid fa-rotate-right"}),loading:Ze,children:ke({en:"Load posts",vi:"Tải bài viết"})})]}),Se&&n.jsxs(D.Compact,{style:{maxWidth:"90vw",marginBottom:10,overflow:"auto"},children:[n.jsx(U,{title:ke({en:"Posted before time",vi:"Đăng trước ngày"}),children:n.jsx(ce,{value:Ue.beforeTime?j(Ue.beforeTime):null,onChange:(Ft="beforeTime",(e,t)=>{T("Posts:onChangeTime"),Ae((e=>l(e,(e=>{if(!t)return void(e[Ft]=null);const n=Array.isArray(t)?t[0]:t;e[Ft]=new Date(n).getTime(),console.log(t,e[Ft])}))))}),maxDate:j(new Date),disabled:ht,style:{minWidth:100,maxWidth:150},placeholder:ke({en:"Before time",vi:"Trước ngày"})})}),n.jsx(U,{title:ke({en:"Posted by",vi:"Đăng bởi"}),children:n.jsxs(le,{style:{minWidth:120},value:Ue.postedByOthers,onChange:e=>{T("Posts:onChangePostedBy:"+e),Ae((t=>l(t,(t=>{t.postedByOthers=e}))))},disabled:ht,popupMatchSelectWidth:!1,children:[n.jsx(le.Option,{value:null,children:ke({en:"Anyone",vi:"Bất kỳ ai"})}),n.jsxs(le.Option,{value:!1,children:["📌 ",ke({en:"Owner",vi:"Chính chủ"})]}),n.jsxs(le.Option,{value:!0,children:["👤 ",ke({en:"Others",vi:"Người khác"})]})]})}),n.jsx(U,{title:ke({en:"Privacy",vi:"Quyền riêng tư"}),children:n.jsx(le,{style:{minWidth:120},value:Ue.privacy,onChange:e=>{T("Posts:onChangePrivacy:"+e),Ae((t=>l(t,(t=>{t.privacy=e}))))},disabled:ht,popupMatchSelectWidth:!1,children:fe.map((e=>n.jsx(le.Option,{value:e,children:ke(c[e])},e)))})}),n.jsx(U,{title:ke({en:"Tagged only",vi:"Chỉ bài viết được gắn thẻ"}),children:n.jsx(o,{icon:n.jsx("i",{className:"fa-solid fa-user-tag"}),type:Ue.taggedInOnly?"primary":"default",onClick:()=>{T("Posts:onToggleTaggedOnly"),Ae((e=>l(e,(e=>{e.taggedInOnly=!e.taggedInOnly}))))},disabled:ht,children:ke({en:"Tagged only",vi:"Gắn thẻ"})})}),n.jsx(U,{title:ke({en:"Ignore pinned post",vi:"Bỏ qua bài viết đã ghim"}),children:n.jsx(o,{icon:n.jsx("i",{className:"fa-solid fa-thumbtack"}),type:Ue.omitPinnedPost?"primary":"default",onClick:()=>{T("Posts:onTogglePinnedPost"),Ae((e=>l(e,(e=>{e.omitPinnedPost=!e.omitPinnedPost}))))},disabled:ht,children:ke({en:"Pinned",vi:"Đã ghim"})})}),St.length>0&&n.jsx(o,{danger:!0,disabled:0===St.length,icon:n.jsx("i",{className:"fa-solid fa-trash-can"}),onClick:()=>Ae(be),children:ke({en:"Reset filters",vi:"Xoá bộ lọc"})})]}),Ie&&n.jsxs(D,{wrap:!0,style:{maxWidth:"90vw",marginBottom:10,justifyContent:"center",gap:10},children:[n.jsxs(U,{mouseEnterDelay:.3,title:ke({en:"Use API v2 to delete posts of page (only turn on if default delete function is not working)",vi:"Sử dụng API phiên bản 2, để xoá bài viết của page (chỉ bật nếu chức năng xoá mặc định không hoạt động)"}),children:[n.jsxs(B.Text,{children:[ke({en:"Delete post v2",vi:"Xoá bài viết v2"}),":"," "]}),n.jsx(he,{checked:Ee,onChange:()=>{Be((e=>!e))},checkedChildren:ke({en:"Delete v2",vi:"Xoá v2"}),unCheckedChildren:ke({en:"Delete v1",vi:"Xoá v1"})})]}),n.jsxs(U,{mouseEnterDelay:.3,title:ke({en:"Auto load reactions for each post",vi:"Tự động tải lượt thích cho từng bài viết"}),children:[n.jsxs(B.Text,{children:[ke({en:"Load reactions",vi:"Tải lượt thích"}),":"," "]}),n.jsx(he,{checked:We,onChange:()=>{Ve((e=>!e))},checkedChildren:ke({en:"Yes",vi:"Có"}),unCheckedChildren:ke({en:"No",vi:"Không"})})]}),n.jsxs(U,{title:ke({en:"Max posts to load",vi:"Số bài viết tối đa muốn tải"}),children:[n.jsxs(B.Text,{children:[ke({en:"Max posts",vi:"Số bài viết tối đa"}),":"," "]}),n.jsx(ue,{placeholder:ke({en:"Max posts",vi:"Số bài viết tối đa"}),value:qe,onChange:e=>ze(Math.max(e||0,1)),style:{minWidth:50,maxWidth:100}})]})]})]}),lt&&n.jsx(D,{align:"center",style:{width:"100%",justifyContent:"center"},children:n.jsx(A,{message:n.jsxs(n.Fragment,{children:[ke({en:'Showing hidden posts. Click "Load posts" to back to normal mode',vi:'Đang hiển thị bài viết ẩn. Nhấn "Tải bài viết" để về chế độ thường'}),n.jsx(o,{type:"link",href:"https://www.facebook.com/groups/fbaio/posts/1708646306456717",target:"_blank",icon:n.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"}),iconPosition:"end",children:ke({en:"Read more",vi:"Đọc thêm"})})]}),type:"info",showIcon:!0,style:{marginBottom:10}})}),n.jsx(K,{data:vt,columns:_t,searchable:!0,selectable:!0,keyExtractor:e=>e.id,renderTitle:e=>{var t;const i=(null==e?void 0:e.length)?e:vt,s=i.filter((e=>(ut||e.can_delete)&&!e.deleted)),a=i.filter((e=>!ht&&e.can_delete&&!e.trashed&&!e.deleted)),l=i.filter((e=>{var t;return(null==(t=e.privacy)?void 0:t.can_edit)&&!e.deleted})),r=i.filter((e=>!Qe[e.id])),d=i.filter((e=>{var t;return!e.can_delete&&(null==Me?void 0:Me.id)==Ke&&Ke!==(null==(t=e.actor)?void 0:t.id)&&!e.untagged}));return n.jsxs(n.Fragment,{children:[n.jsxs(D.Compact,{children:[n.jsx(X,{data:e.length?e:vt,options:[{key:"json",label:".json",prepareData:e=>({fileName:"posts.json",data:JSON.stringify(e,null,4)})}]}),Dt]}),n.jsxs(D.Compact,{children:[n.jsx(J,{type:"hot",children:n.jsx(U,{mouseEnterDelay:.4,title:ke({en:"Find first posts",vi:"Tìm bài viết đầu tiên"}),children:n.jsx(o,{loading:tt,icon:n.jsx("i",{className:"fa-solid fa-clock-rotate-left"}),onClick:pt,disabled:ht,children:ke({en:"First posts",vi:"Bài đầu tiên"})})})}),n.jsx(J,{type:"new",children:n.jsx(U,{mouseEnterDelay:.4,title:ke({en:"Find all posts (owned/tagged) of this profile on Facebook",vi:"Tìm tất cả bài viết (trên hội nhóm/được tag) của người dùng này trên Facebook"}),children:n.jsx(o,{type:lt?"primary":"default",icon:n.jsx("i",{className:"fa-solid fa-eye-slash"}),onClick:wt,children:ke({en:"Find hidden posts",vi:"Tìm bài viết ẩn"})})})})]}),n.jsxs(D.Compact,{children:[r.length>0&&n.jsx(U,{mouseEnterDelay:.3,title:ke({en:"Load post reactions of "+r.length+" posts",vi:"Tải lượt thích của "+r.length+" bài viết"}),children:n.jsxs(o,{loading:it,icon:n.jsx("i",{className:"fa-solid fa-thumbs-up"}),onClick:()=>yt(r),children:[ke({en:"Reactions ",vi:"Thích "}),r.length]})}),s.length>0&&n.jsx(U,{mouseEnterDelay:.3,title:ke({en:`Delete permanently ${s.length} posts`,vi:`Xoá vĩnh viễn ${s.length} bài viết`}),children:n.jsxs(o,{danger:!0,icon:n.jsx("i",{className:"fa-solid fa-trash"}),onClick:()=>(async e=>De({data:e,key:"Posts:onDeleteBulk",actionFn:ft,loadingText:e=>ke({en:"Deleting post...",vi:"Đang xoá bài viết..."}),successText:e=>ke({en:"Deleted posts",vi:"Hoàn tất xoá bài viết"}),successDescItem:e=>je(e),confirmProps:{title:ke({en:"Delete "+e.length+" posts?",vi:"Xoá "+e.length+" bài viết?"}),text:ke({en:"Warning: Cannot undo",vi:"Lưu ý: Không thể hoàn tác."})}}))(s),children:[ke({en:"Delete",vi:"Xoá"})," ",s.length]})}),a.length>0&&n.jsx(U,{mouseEnterDelay:.3,title:ke({en:`Move to trash ${a.length} posts`,vi:`Chuyển vào thùng rác ${a.length} bài viết`}),children:n.jsxs(o,{icon:n.jsx("i",{className:"fa-solid fa-eye-slash"}),onClick:()=>(async e=>De({data:e,key:"Posts:onTrashBulk",actionFn:jt,loadingText:e=>ke({en:"Moving to trash...",vi:"Đang chuyển vào thùng rác..."}),successText:e=>ke({en:"Trashed posts",vi:"Hoàn tất chuyển vào thùng rác"}),successDescItem:e=>je(e),confirmProps:{title:ke({en:"Move to trash "+e.length+" posts?",vi:"Chuyển vào thùng rác "+e.length+" bài viết?"}),text:ke({en:"Warning: Will be deleted after 30 days",vi:"Lưu ý: Sẽ bị xoá sau 30 ngày"})}}))(a),children:[ke({en:"Trash",vi:"Rác"})," ",a.length]})}),l.length>0&&n.jsx(U,{mouseEnterDelay:.3,title:ke({en:"Change privacy "+l.length+" posts",vi:"Sửa quyền riêng tư "+l.length+" bài viết"}),children:n.jsx(le,{value:null==(t=l[0].privacy)?void 0:t.scope,options:xe.map((e=>({value:e,label:ke(c[e])}))),onSelect:e=>{(async(e,t)=>{const n=ke(c[t]);De({data:e,key:"Posts:onChangePrivacyBulk",actionFn:e=>t===e.privacy.scope||bt(e,t),loadingText:e=>ke({en:"Changing post privacy...",vi:"Đang sửa quyền riêng tư..."})+n,successText:e=>ke({en:"Chaged posts privacy: ",vi:"Hoàn tất sửa quyền riêng tư: "})+n,successDescItem:e=>je(e)+": "+F(e.id),confirmProps:{title:ke({en:"Changed privacy "+e.length+" posts?",vi:"Sửa quyền riêng tư "+e.length+" bài viết?"}),text:n}})})(l,e)},popupMatchSelectWidth:!1})}),d.length>0&&n.jsx(U,{mouseEnterDelay:.3,title:ke({en:"Untag "+d.length+" posts",vi:"Gỡ thẻ "+d.length+" bài viết"}),children:n.jsxs(o,{danger:!0,icon:n.jsx("i",{className:"fa-solid fa-user-tag"}),onClick:()=>(async e=>De({data:e,key:"Posts:onUntagBulk",actionFn:kt,loadingText:e=>ke({en:"Untagging posts...",vi:"Đang gỡ thẻ bài viết..."}),successText:e=>ke({en:"Untagged posts",vi:"Hoàn tất gỡ thẻ bài viết"}),successDescItem:e=>je(e),confirmProps:{title:ke({en:"Untag "+e.length+" posts?",vi:"Gỡ thẻ "+e.length+" bài viết?"}),text:ke({en:"Warning: Cannot undo",vi:"Lưu ý: Không thể hoàn tác."})}}))(d),children:[ke({en:"Untag",vi:"Gỡ thẻ"})," ",d.length]})})]})]})},footer:n.jsx(ve,{align:"middle",justify:"center",style:{width:"100%"},children:Dt})}),n.jsx(me,{open:!!st,onCancel:()=>at(null),footer:null,width:"90vw",children:st&&n.jsx(pe,{target:st.actor,postId:st.id})})]});var Ft}export{ke as default};
