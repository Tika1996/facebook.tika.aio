const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ArchivedStoryViewer-C-aWXh1s.js","./index-DZEcYG8Q.js","./index-C6k8ZUm0.css","./MyApp-DRRa55Bd.js","./useCacheState-D4ghBCVU.js","./stories-DAeaujzo.js","./index-BE0FsmaM.js","./EyeOutlined-BBPXKIU8.js","./addEventListener-C9VBchln.js","./index-DhxhS065.js","./useBreakpoint-HjQEkdEA.js","./index-C0Edlh-n.js","./index-CiDxWY8X.js","./Dropdown-BgvXKd3u.js"])))=>i.map(i=>d[i]);
import{r as e,b1 as t,b2 as o,b5 as i,bi as s,aY as r}from"./index-DZEcYG8Q.js";import{u as n,d as a,t as d,S as l,c,f as m,p,h as j,w as u,v as x,I as h}from"./MyApp-DRRa55Bd.js";import g from"./Collection-DTYRwOd8.js";import{getCacheByKey as f,setCacheByKey as v}from"./useCacheState-D4ghBCVU.js";import{getArchivedStories as y,getArchivedStoriesContent as b,deleteArchivedStory as w}from"./stories-DAeaujzo.js";import{u as k}from"./useAction-DQs_XsxB.js";import{u as _}from"./useDevMode-DFNrRWnS.js";import{L as S}from"./index-CG5dclLJ.js";import{I as D}from"./index-BE0FsmaM.js";import"./index-BA5m7QhG.js";import"./react-hotkeys-hook.esm-D8zm19cE.js";import"./index-C0Edlh-n.js";import"./index-BQAhaSn9.js";import"./index-CEGXIRel.js";import"./index-KPoWFIyW.js";import"./dropdown-BoVCRztz.js";import"./Dropdown-BgvXKd3u.js";import"./PurePanel-Beni9Vkb.js";import"./move-Bzyc79vL.js";import"./index-B87p3I4c.js";import"./Input-LTpJ6AuY.js";import"./EyeOutlined-BBPXKIU8.js";import"./SearchOutlined-Bh66KhXc.js";import"./row-BgRGnxnv.js";import"./useBreakpoint-HjQEkdEA.js";import"./index-DHhmxYJT.js";import"./index-D9U4WvIE.js";import"./List-BPJoeCz4.js";import"./index-CvALG2oX.js";import"./DownOutlined-BrkIPj-I.js";import"./Pagination-Dv2YSLQ3.js";import"./col-DLTiGXF3.js";import"./useVIP-CGpIDALh.js";import"./sweetalert2.esm.all-BZxvatOx.js";import"./getIds-BE6G2xp0.js";import"./index-CiDxWY8X.js";import"./addEventListener-C9VBchln.js";const T=o((()=>r((()=>import("./ArchivedStoryViewer-C-aWXh1s.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),{fallback:h});function A(){const{ti:o}=n(),{message:r}=a(),{onClickAction:h,onClickBulkActions:A}=k(),{devMode:C}=_();e.useEffect((()=>{d("ArchivedStories:onLoad")}),[]);const I=async(e,t,i=!1)=>h({record:e,id:e.id,key:"ArchivedStories.deleteStory",actionFn:()=>C?x(1e3):w(e.id),loadingText:()=>o({en:"Deleting story...",vi:"ƒêang x√≥a story..."})+e.creation_time,successText:()=>o({en:"Story deleted. ",vi:"ƒêaÃÉ x√≥a story. "})+e.creation_time,failedText:()=>o({en:"Failed to delete story. ",vi:"Ch∆∞a x√≥a ƒë∆∞·ª£c story. "})+e.creation_time,onSuccess:()=>{t((t=>s(t,(t=>{const o=t.find((t=>t.id===e.id));return o&&(o.deleted=!0),t}))))},needConfirm:i,confirmProps:{title:o({en:"Delete this story?",vi:"Xo√° story n√†y?"})}});return t.jsx(g,{collectionName:"Archived Stories",fetchNext:async(e,t)=>{var o;return await y(t||(null==(o=null==e?void 0:e[e.length-1])?void 0:o.cursor)||"")},renderItem:(e,s,r)=>{const n=e.deleted;return t.jsxs(S.Item,{className:"show-on-hover-trigger",children:[t.jsx(D,{src:e.thumbnail,style:{width:160,height:270,borderRadius:10,objectFit:"cover"},preview:!n&&{destroyOnHidden:!0,toolbarRender:()=>null,imageRender:()=>t.jsx(T,{story:e})}}),t.jsxs(l,{direction:"vertical",style:{background:"linear-gradient(0deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%)",position:"absolute",bottom:0,left:0,width:"100%",padding:"5px 10px",paddingTop:"50px",pointerEvents:"none"},children:[n&&t.jsx(c.Text,{style:{color:"red",fontWeight:"bold",backgroundColor:"#3339",padding:5,fontSize:"1.2em",width:"100%"},children:o({en:"DELETED",vi:"ƒê√É XO√Å"})}),t.jsxs(c.Text,{style:{color:"#ccc"},children:[t.jsxs("span",{children:[t.jsx("i",{className:"fa fa-eye"})," ",e.seen_count]}),t.jsx("br",{}),t.jsxs("span",{children:[t.jsx("i",{className:"fa fa-clock"})," ",p((new Date).getTime()-new Date(e.creation_time).getTime())]}),t.jsx("br",{}),m(new Date(e.creation_time))]})]}),!n&&t.jsxs(l,{className:"show-on-hover-item",style:{position:"absolute",top:10,right:10},size:3,children:[t.jsx(i,{danger:!0,type:"default",icon:t.jsx("i",{className:"fa-solid fa-trash-can"}),onClick:()=>I(e,r,!0)}),t.jsx(i,{type:"default",icon:t.jsx("i",{className:"fa-solid fa-up-right-from-square"}),target:"_blank",href:j("stories/?card_id="+e.id)})]})]})},downloadItem:async e=>{const t="ArchivedStoryViewer.stories."+e.creation_time,o=f(t)||await b({creationTime:e.creation_time});v(t,o);const i=o.find((t=>t.id===e.id)),s=u(new Date(e.creation_time));return[{url:(null==i?void 0:i.video)||(null==i?void 0:i.image)||"",name:s+((null==i?void 0:i.video)?".mp4":".jpg")},{url:(null==i?void 0:i.image_background)||"",name:s+"_bg.jpg"}].filter((e=>null==e?void 0:e.url))},headerButtons:e=>t.jsx(i,{onClick:()=>{window.open("https://www.facebook.com/me/allactivity?log_filter=archivedstories","_blank")},icon:t.jsx("i",{className:"fa fa-external-link-alt"}),children:o({vi:"Xem tr√™n Facebook",en:"View on Facebook"})},"view-fb"),getItemCursor:e=>null==e?void 0:e.cursor,rowKey:e=>e.id,downloadOptions:[{key:"delete-story",labelFn:e=>{const t=e.filter((e=>!e.deleted)).length;return o({en:`üóëÔ∏è Delete ${t} story`,vi:`üóëÔ∏è Xo√° ${t} story`})},onClick:async(e,t)=>{const i=e.filter((e=>!e.deleted));return console.log(i),i.length?A({key:"ArchivedStories.deleteSelectedStories",data:i,actionFn:e=>I(e,t,!1),loadingText:()=>o({en:"Deleting stories...",vi:"ƒêang x√≥a story..."}),successText:()=>o({en:"Stories deleted!",vi:"X√≥a story xong!"}),confirmProps:{title:o({en:"Delete "+i.length+" stories?",vi:"Xo√° "+i.length+" story?"}),text:o({en:"This action can not be undo",vi:"Kh√¥ng th·ªÉ ho√†n t√°c"})}}):r.error(o({en:"There is no story to delete",vi:"Kh√¥ng c√≤n story n√†o c·∫ßn xo√°"}))}}]})}export{A as default};
